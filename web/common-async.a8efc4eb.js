(("undefined"!=typeof globalThis?globalThis:self)["makoChunk_ant-design-pro"]=("undefined"!=typeof globalThis?globalThis:self)["makoChunk_ant-design-pro"]||[]).push([["common"],{"03015425":function(e,t,r){"use strict";r.d(t,"__esModule",{value:!0}),r.d(t,"default",{enumerable:!0,get:function(){return c;}});var a=r("777fffbe"),o=r("26e051b7"),s=r("76b52bba"),i=r("a8e90e34"),n=r("1fc97d93"),d=a._(r("6a64c6d6")),p=a._(r("dc9ef55b")),u=r("ae74910a");function c({isOpen:e,onClose:t,onConfirm:r,agentID:a}){let c=(0,u.useIntl)(),[l,y]=(0,s.useState)(""),[f,m]=(0,s.useState)(""),v=async()=>{if(6!==l.length){m(c.formatMessage({id:"pages.addDevice.verificationCode.error",defaultMessage:"\u8BF7\u8F93\u51656\u4F4D\u6570\u5B57\u9A8C\u8BC1\u7801"}));return;}try{await i.API.post("/api/user/device/bind",JSON.stringify({agentID:a,authCode:l}),{headers:{"Content-Type":"application/json"}}),y(""),m(""),r&&r(l),t();}catch(t){var e,o;(0,n.showError)((null==t?void 0:null===(o=t.response)||void 0===o?void 0:null===(e=o.data)||void 0===e?void 0:e.message)||t);}};return e?(0,o.jsx)(p.default,{title:c.formatMessage({id:"pages.addDevice.modal.title",defaultMessage:"\u6DFB\u52A0\u8BBE\u5907"}),open:e,onCancel:()=>{y(""),m(""),t();},onOk:v,okButtonProps:{disabled:6!==l.trim().length},children:(0,o.jsx)("div",{children:(0,o.jsxs)("div",{children:[(0,o.jsxs)("label",{children:[(0,o.jsx)("span",{children:"*"})," ",c.formatMessage({id:"pages.addDevice.verificationCode.label",defaultMessage:"\u9A8C\u8BC1\u7801\uFF1A"})]}),(0,o.jsx)(d.default,{type:"text",value:l,onChange:e=>{y(e.target.value.replace(/\D/g,"").slice(0,6)),m("");},placeholder:c.formatMessage({id:"pages.addDevice.verificationCode.placeholder",defaultMessage:"\u8BF7\u8F93\u5165\u8BBE\u5907\u64AD\u62A5\u76846\u4F4D\u6570\u9A8C\u8BC1\u7801"}),maxLength:6,inputMode:"numeric",pattern:"[0-9]*"}),f&&(0,o.jsx)("div",{children:f})]})})}):null;}},"1fc97d93":function(e,t,r){r.d(t,"__esModule",{value:!0}),r.e(t,{isMobile:function(){return n;},showError:function(){return d;}});var a=r("777fffbe"),o=r("795f1363"),s=r("e27282e4"),i=a._(s);function n(){return window.innerWidth<=600;}function d(e){if(console.error(e),e.message){if("AxiosError"===e.name||e instanceof o.AxiosError){var t,r,a;switch(null===(t=e.response)||void 0===t?void 0:t.status){case 401:i.default.error("\u9519\u8BEF\uFF1A\u672A\u767B\u5F55\u6216\u767B\u5F55\u5DF2\u8FC7\u671F\uFF0C\u8BF7\u91CD\u65B0\u767B\u5F55\uFF01"),window.location.href="/login";break;case 429:i.default.error("\u9519\u8BEF\uFF1A\u8BF7\u6C42\u6B21\u6570\u8FC7\u591A\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5\uFF01");break;case 500:i.default.error("\u9519\u8BEF\uFF1A\u670D\u52A1\u5668\u5185\u90E8\u9519\u8BEF\uFF0C\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458\uFF01");break;case 400:(null===(a=e.response)||void 0===a?void 0:null===(r=a.data)||void 0===r?void 0:r.error)?i.default.error(e.response.data.error):i.default.error("\u9519\u8BEF\uFF1A"+e.message);break;case 405:i.default.info("\u672C\u7AD9\u4EC5\u4F5C\u6F14\u793A\u4E4B\u7528\uFF0C\u65E0\u670D\u52A1\u7AEF\uFF01");break;case 403:case 404:break;default:i.default.error("\u9519\u8BEF\uFF1A"+e.message);}return;}i.default.error("\u9519\u8BEF\uFF1A"+e.message);}else i.default.error("\u9519\u8BEF\uFF1A"+e);}n();},"23f8e02c":function(e,t,r){"use strict";function a(){let e=localStorage.getItem("user");if(!e)return{};try{let t=JSON.parse(e);if(t&&t.token)return{Authorization:"Bearer "+t.token};return{};}catch(e){return console.error("Error parsing user data:",e),{};}}r.d(t,"__esModule",{value:!0}),r.d(t,"authHeader",{enumerable:!0,get:function(){return a;}});},"9a7ec01c":function(e,t,r){"use strict";r.d(t,"__esModule",{value:!0}),r.d(t,"ENV",{enumerable:!0,get:function(){return a;}});let a={API_BASE_URL:window.location.origin,isDev:!1,isProd:!0};},"9acd0375":function(e,t,r){"use strict";r.d(t,"__esModule",{value:!0}),r.d(t,"systemApi",{enumerable:!0,get:function(){return s;}});var a=r("9a7ec01c"),o=r("a8e90e34");a.ENV.API_BASE_URL;let s=new class{parseProviderConfig(e){try{return JSON.parse(e);}catch(e){throw console.error("\u89E3\u6790provider\u914D\u7F6E\u5931\u8D25:",e),Error("Invalid provider configuration");}}async getDeviceListByAgent(e){try{return(await o.API.get(`/api/user/device/list/${e}`)).data;}catch(e){return console.error("\u83B7\u53D6\u8BBE\u5907\u5217\u8868\u5931\u8D25:",e),[];}}parseProvidersResponse(e,t){let r=[];return Object.entries(e.data).forEach(([e,a])=>{try{let o=this.parseProviderConfig(a),s={id:e,name:e,type:t,status:"active",config:o,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};r.push(s);}catch(t){console.error(`\u{89E3}\u{6790}provider ${e} \u{5931}\u{8D25}:`,t);}}),r;}convertToModelProvider(e){let t={};if("LLM"===e.type||"VLLLM"===e.type){let r=e.config;t.apiKey=r.api_key,t.endpoint=r.url,t.model=r.model_name,t.temperature=r.temperature,t.maxTokens=r.max_tokens,t.topP=r.top_p,t.type=r.type,t.extra=r.extra,"VLLLM"===e.type&&(t.security=r.security);}else if("ASR"===e.type){let r=e.config;t.type=r.type,t.accessToken=r.access_token,t.appid=r.appid,t.cluster=r.cluster,t.outputDir=r.output_dir;}else if("TTS"===e.type){let r=e.config;t.type=r.type,t.voice=r.voice,t.format=r.format,t.outputDir=r.output_dir||r.outputDir||"",t.appid=r.appid,t.token=r.token,t.cluster=r.cluster;let a=r.supported_voices||r.surported_voices||r.supportedVoices||null;Array.isArray(a)?(t.supportedVoices=a.map(e=>"string"==typeof e?e:(null==e?void 0:e.name)||""),t.supportedVoices.every(e=>!e)&&(t.supportedVoices=null)):t.supportedVoices=null,t.supported_voices=Array.isArray(a)?a:null;}return{id:e.id,name:e.name,type:e.type,status:e.status,config:t,createdAt:e.createdAt,updatedAt:e.updatedAt};}convertFormDataToConfig(e){let t=e.config,r=e.subType;if("LLM"===e.type)return{type:r,model_name:t.model_name||t.model||"",url:t.url||t.endpoint||"",api_key:t.api_key||t.apiKey||"",temperature:t.temperature||.7,max_tokens:t.max_tokens||t.maxTokens||2e3,top_p:t.top_p||t.topP||1,extra:t.extra||{}};if("VLLLM"===e.type)return{type:r,model_name:t.model_name||t.model||"",url:t.url||t.endpoint||"",api_key:t.api_key||t.apiKey||"",temperature:t.temperature||.7,max_tokens:t.max_tokens||t.maxTokens||2e3,top_p:t.top_p||t.topP||1,extra:t.extra||{},security:t.security||{max_file_size:10485760,max_pixels:16777216,max_width:4096,max_height:4096,allowed_formats:["jpeg","jpg","png","webp"],enable_deep_scan:!0,validation_timeout:"30s"}};if("ASR"===e.type)return{type:r,access_token:t.access_token||t.accessToken||"",appid:t.appid||"",cluster:t.cluster||"",output_dir:t.output_dir||t.outputDir||"",grpc_host:t.grpc_host||"",grpc_port:t.grpc_port||0,gosherpa_model:t.gosherpa_model||""};if("TTS"===e.type)return{type:r,voice:t.voice||"",format:t.format||"mp3",output_dir:t.output_dir||t.outputDir||"",appid:t.appid||"",token:t.token||"",cluster:t.cluster||"",supportedVoices:t.supportedVoices||(Array.isArray(t.supported_voices)?t.supported_voices.map(e=>e.name):null),supported_voices:t.supported_voices||null,edge_voice:t.edge_voice||"",siliconflow_api_key:t.siliconflow_api_key||"",siliconflow_base_url:t.siliconflow_base_url||""};throw Error(`Unsupported provider type: ${e.type}`);}async getSystemConfig(){try{let e=await o.API.get("/api/admin/system");if(e.data&&"string"==typeof e.data)return JSON.parse(e.data);return e.data;}catch(e){return console.error("\u83B7\u53D6\u7CFB\u7EDF\u914D\u7F6E\u5931\u8D25:",e),{selectedASR:"",selectedTTS:"",selectedLLM:"",selectedVLLLM:"",prompt:"",quickReplyWords:[],deleteAudio:!1,usePrivateConfig:!1};}}async saveSystemConfig(e){await o.API.post("/api/admin/system",{data:JSON.stringify(e)});}async getASRProviders(){try{let e=await o.API.get("/api/user/providers/ASR");return Object.keys(e.data);}catch(e){return console.error("\u83B7\u53D6ASR\u63D0\u4F9B\u5546\u5217\u8868\u5931\u8D25:",e),[];}}async getTTSProviders(){try{let e=await o.API.get("/api/user/providers/TTS");return Object.keys(e.data);}catch(e){return console.error("\u83B7\u53D6TTS\u63D0\u4F9B\u5546\u5217\u8868\u5931\u8D25:",e),[];}}async getLLMProviders(){try{let e=await o.API.get("/api/user/providers/LLM");return Object.keys(e.data);}catch(e){return console.error("\u83B7\u53D6LLM\u63D0\u4F9B\u5546\u5217\u8868\u5931\u8D25:",e),[];}}async getVLLLMProviders(){try{let e=await o.API.get("/api/user/providers/VLLLM");return Object.keys(e.data);}catch(e){return console.error("\u83B7\u53D6VLLLM\u63D0\u4F9B\u5546\u5217\u8868\u5931\u8D25:",e),[];}}async getProviderOptions(e){try{let t=await o.API.get(`/api/user/providers/${e}`),r=[];return Object.entries(t.data).forEach(([t,a])=>{try{let o=this.parseProviderConfig(a),s=t;"LLM"===e||"VLLLM"===e?s=`${t} (${o.model_name})`:"TTS"===e?s=`${t} (${o.type})`:"ASR"===e&&(s=`${t} (${o.type})`),r.push({name:t,displayName:s});}catch(e){console.error(`\u{89E3}\u{6790}provider ${t} \u{914D}\u{7F6E}\u{5931}\u{8D25}:`,e),r.push({name:t,displayName:t});}}),r;}catch(t){return console.error(`\u{83B7}\u{53D6}${e}\u{63D0}\u{4F9B}\u{5546}\u{9009}\u{9879}\u{5931}\u{8D25}:`,t),[];}}async getModelProviders(){try{let[e,t,r,a]=await Promise.all([o.API.get("/api/user/providers/ASR"),o.API.get("/api/user/providers/TTS"),o.API.get("/api/user/providers/LLM"),o.API.get("/api/user/providers/VLLLM")]),s=e.data,i=t.data,n=r.data,d=a.data,p=this.parseProvidersResponse(s,"ASR"),u=this.parseProvidersResponse(i,"TTS"),c=this.parseProvidersResponse(n,"LLM"),l=this.parseProvidersResponse(d,"VLLLM");return[...p,...u,...c,...l].map(e=>this.convertToModelProvider(e));}catch(e){throw console.error("\u83B7\u53D6\u6A21\u578B\u4F9B\u5E94\u5546\u5931\u8D25:",e),e;}}async getProvidersByType(e){try{let t=await o.API.get(`/api/user/providers/${e}`).then(e=>e.data);return this.parseProvidersResponse(t,e).map(e=>this.convertToModelProvider(e));}catch(t){throw console.error(`\u{83B7}\u{53D6}${e}\u{4F9B}\u{5E94}\u{5546}\u{5931}\u{8D25}:`,t),t;}}async createModelProvider(e){let t=this.convertFormDataToConfig(e);return o.API.post("/api/user/providers/create",{type:e.type,name:e.name,data:t}).then(e=>e.data);}async updateModelProvider(e,t,r){if(!e||!t)throw Error("\u66F4\u65B0\u4F9B\u5E94\u5546\u65F6\uFF0Ctype \u548C name \u53C2\u6570\u90FD\u4E0D\u80FD\u4E3A\u7A7A");let a=["ASR","TTS","LLM","VLLLM"];if(!a.includes(e))throw Error(`\u{65E0}\u{6548}\u{7684}\u{4F9B}\u{5E94}\u{5546}\u{7C7B}\u{578B}: ${e}\u{FF0C}\u{6709}\u{6548}\u{7C7B}\u{578B}\u{4E3A}: ${a.join(", ")}`);return o.API.put(`/api/user/providers/${e}/${t}`,{data:r}).then(e=>e.data).catch(e=>{throw console.error("\u66F4\u65B0\u4F9B\u5E94\u5546\u5931\u8D25:",e),e;});}async updateModelProviderFromForm(e,t,r){let a={type:e,name:t,subType:r.subType||"openai",config:r.config||{}},o=this.convertFormDataToConfig(a);return this.updateModelProvider(e,t,o);}async deleteModelProvider(e,t){if(!e||!t)throw Error("\u5220\u9664\u4F9B\u5E94\u5546\u65F6\uFF0Ctype \u548C name \u53C2\u6570\u90FD\u4E0D\u80FD\u4E3A\u7A7A");let r=["ASR","TTS","LLM","VLLLM"];if(!r.includes(e))throw Error(`\u{65E0}\u{6548}\u{7684}\u{4F9B}\u{5E94}\u{5546}\u{7C7B}\u{578B}: ${e}\u{FF0C}\u{6709}\u{6548}\u{7C7B}\u{578B}\u{4E3A}: ${r.join(", ")}`);await o.API.delete(`/api/user/providers/${e}/${t}`);}async testModelProvider(e,t){if(!e||!t)throw Error("\u6D4B\u8BD5\u4F9B\u5E94\u5546\u65F6\uFF0Ctype \u548C name \u53C2\u6570\u90FD\u4E0D\u80FD\u4E3A\u7A7A");let r=["ASR","TTS","LLM","VLLLM"];if(!r.includes(e))throw Error(`\u{65E0}\u{6548}\u{7684}\u{4F9B}\u{5E94}\u{5546}\u{7C7B}\u{578B}: ${e}\u{FF0C}\u{6709}\u{6548}\u{7C7B}\u{578B}\u{4E3A}: ${r.join(", ")}`);return o.API.post(`/api/user/providers/${e}/${t}/test`).then(e=>e.data);}async toggleModelProviderStatus(e,t){if(!e||!t)throw Error("\u5207\u6362\u4F9B\u5E94\u5546\u72B6\u6001\u65F6\uFF0Ctype \u548C name \u53C2\u6570\u90FD\u4E0D\u80FD\u4E3A\u7A7A");let r=["ASR","TTS","LLM","VLLLM"];if(!r.includes(e))throw Error(`\u{65E0}\u{6548}\u{7684}\u{4F9B}\u{5E94}\u{5546}\u{7C7B}\u{578B}: ${e}\u{FF0C}\u{6709}\u{6548}\u{7C7B}\u{578B}\u{4E3A}: ${r.join(", ")}`);return o.API.post(`/api/user/providers/${e}/${t}/toggle`).then(e=>e.data);}async getUserList(e){return(await o.API.get("/api/admin/user/list",{params:e})).data;}async editUser(e,t){return(await o.API.put(`/api/admin/user/edit/${e}`,t)).data;}async getWhiteList(e){return(await o.API.get("/api/admin/system/whiteList",{params:e})).data;}async addWhiteList(e){return(await o.API.post("/api/admin/system/whiteList/add",{mac:e})).data;}async deleteWhiteList(e){return(await o.API.delete("/api/admin/system/whiteList",{data:JSON.stringify({mac:e}),headers:{"Content-Type":"application/json"}})).data;}};},b9dd02eb:function(e,t,r){},d68a3473:function(e,t,r){"use strict";r.d(t,"__esModule",{value:!0});var a=r("d1751d7c");a._(r("b9dd02eb"),t),a._(r("1fc97d93"),t),a._(r("a8e90e34"),t);}}]);
//# sourceMappingURL=common-async.a8efc4eb.js.map