(("undefined"!=typeof globalThis?globalThis:self)["makoChunk_ant-design-pro"]=("undefined"!=typeof globalThis?globalThis:self)["makoChunk_ant-design-pro"]||[]).push([["49fa7062"],{"6ed1fab4":function(e,a,t){t.d(a,"__esModule",{value:!0}),t.e(a,{default:function(){return W;}});var s=t("777fffbe"),o=t("852bbaa9"),r=t("26e051b7"),i=t("38299514"),l=s._(i),n=t("7aab5c8a"),d=s._(n),u=t("412e627e"),f=t("9fd74b0b"),g=s._(f),c=t("045faad8"),p=s._(c),m=t("32d1e0c7"),h=t("ae106c22"),v=s._(h),x=t("76b52bba"),b=o._(x),M=t("62d2a1d1"),j=t("f7a6aed4"),y=s._(j),A=["options","fieldProps","proFieldProps","valueEnum"],P=b.default.forwardRef(function(e,a){var t=e.options,s=e.fieldProps,o=e.proFieldProps,i=e.valueEnum,l=(0,p.default)(e,A);return(0,r.jsx)(y.default,(0,g.default)({ref:a,valueType:"checkbox",valueEnum:(0,m.runFunction)(i,void 0),fieldProps:(0,g.default)({options:t},s),lightProps:(0,g.default)({labelFormatter:function(){return(0,r.jsx)(y.default,(0,g.default)({ref:a,valueType:"checkbox",mode:"read",valueEnum:(0,m.runFunction)(i,void 0),filedConfig:{customLightMode:!0},fieldProps:(0,g.default)({options:t},s),proFieldProps:o},l));}},l.lightProps),proFieldProps:o},l));}),_=b.default.forwardRef(function(e,a){var t=e.fieldProps,s=e.children;return(0,r.jsx)(v.default,(0,g.default)((0,g.default)({ref:a},t),{},{children:s}));}),w=(0,M.createField)(_,{valuePropName:"checked"});w.Group=P;var F=t("bddd5bec"),S=s._(F),k=t("ae74910a"),L=t("9df09342"),z=s._(L),C=t("13ed6381"),I=s._(C),T=t("22443452"),E=s._(T),R=t("e497e64f"),q=t("4d8214cc"),N=t("4f1e0f19"),B=t("b6af8abe"),H=s._(B),U=t("d68a3473");let V=(0,R.createStyles)(({token:e})=>({action:{marginLeft:"8px",color:"rgba(0, 0, 0, 0.2)",fontSize:"24px",verticalAlign:"middle",cursor:"pointer",transition:"color 0.3s","&:hover":{color:e.colorPrimaryActive}},lang:{width:42,height:42,lineHeight:"42px",position:"fixed",right:16,borderRadius:e.borderRadius,":hover":{backgroundColor:e.colorBgTextHover}},container:{display:"flex",flexDirection:"column",height:"100vh",overflow:"auto",backgroundImage:"url('https://mdn.alipayobjects.com/yuyan_qk0oxh/afts/img/V-_oS6r-i7wAAAAAAAAAAAAAFl94AQBr')",backgroundSize:"100% 100%"}})),J=()=>{let{styles:e}=V();return(0,r.jsx)("div",{className:e.lang,"data-lang":!0,children:k.SelectLang&&(0,r.jsx)(k.SelectLang,{})});},O=({content:e})=>(0,r.jsx)(z.default,{style:{marginBottom:24},message:e,type:"error",showIcon:!0}),W=()=>{var e,a,t;let[s,o]=(0,b.useState)({}),[i,n]=(0,b.useState)("account"),{initialState:f,setInitialState:g}=(0,k.useModel)("@@initialState"),{styles:c}=V(),{message:p}=I.default.useApp(),m=(0,k.useIntl)(),h=async()=>{var e;let a=await (null==f?void 0:null===(e=f.fetchUserInfo)||void 0===e?void 0:e.call(f));a&&(0,q.flushSync)(()=>{g(e=>({...e,currentUser:a}));});},v=async e=>{try{var a;let t=await U.API.post("/api/user/login",JSON.stringify({username:e.username,password:e.password}),{headers:{"Content-Type":"application/json"}});if((null===(a=t.data)||void 0===a?void 0:a.status)==="ok"){let e=m.formatMessage({id:"pages.login.success",defaultMessage:"\u767B\u5F55\u6210\u529F\uFF01"});p.success(e),localStorage.setItem("user",JSON.stringify(t.data.data)),await h(),k.history.push("/welcome"),console.log("\u767B\u5F55\u6210\u529F\uFF0C\u8DF3\u8F6C\u5230\u63A7\u5236\u53F0 welcome \u9875\u9762");return;}o(t);}catch(a){let e=m.formatMessage({id:"pages.login.failure",defaultMessage:"\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5\uFF01"});console.log(a),p.error(e);}},{status:x,type:M}=s;return(0,r.jsxs)("div",{className:c.container,children:[(0,r.jsx)(k.Helmet,{children:(0,r.jsxs)("title",{children:[m.formatMessage({id:"menu.login",defaultMessage:"\u767B\u5F55\u9875"}),((null==f?void 0:null===(e=f.branding)||void 0===e?void 0:e.title)||H.default.title)&&` - ${(null==f?void 0:null===(a=f.branding)||void 0===a?void 0:a.title)||H.default.title}`]})}),(0,r.jsx)(J,{}),(0,r.jsx)("div",{style:{flex:"1",padding:"32px 0"},children:(0,r.jsxs)(u.LoginForm,{contentStyle:{minWidth:280,maxWidth:"75vw",marginTop:"32px"},title:(null==f?void 0:null===(t=f.branding)||void 0===t?void 0:t.title)||m.formatMessage({id:"pages.login.title",defaultMessage:"Anime AI Chat \u7BA1\u7406\u63A7\u5236\u53F0"}),initialValues:{autoLogin:!0},onFinish:async e=>{if("mobile"===i){p.info(m.formatMessage({id:"pages.login.mobile.notAvailable",defaultMessage:"\u6B64\u529F\u80FD\u6682\u672A\u5F00\u653E\uFF0C\u8BF7\u4F7F\u7528\u8D26\u6237\u5BC6\u7801\u767B\u5F55"}));return;}await v(e);},children:[(0,r.jsx)(E.default,{activeKey:i,onChange:n,centered:!0,items:[{key:"account",label:m.formatMessage({id:"pages.login.accountLogin.tab",defaultMessage:"\u8D26\u6237\u5BC6\u7801\u767B\u5F55"})}]}),"error"===x&&"account"===M&&(0,r.jsx)(O,{content:m.formatMessage({id:"pages.login.accountLogin.errorMessage",defaultMessage:"\u8D26\u6237\u6216\u5BC6\u7801\u9519\u8BEF(admin/ant.design)"})}),"account"===i&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(S.default,{name:"username",fieldProps:{size:"large",prefix:(0,r.jsx)(d.default,{})},placeholder:m.formatMessage({id:"pages.login.username.placeholder",defaultMessage:"\u7528\u6237\u540D: admin or user"}),rules:[{required:!0,message:(0,r.jsx)(k.FormattedMessage,{id:"pages.login.username.required",defaultMessage:"\u8BF7\u8F93\u5165\u7528\u6237\u540D!"})}]}),(0,r.jsx)(S.default.Password,{name:"password",fieldProps:{size:"large",prefix:(0,r.jsx)(l.default,{})},placeholder:m.formatMessage({id:"pages.login.password.placeholder",defaultMessage:"\u5BC6\u7801: ant.design"}),rules:[{required:!0,message:(0,r.jsx)(k.FormattedMessage,{id:"pages.login.password.required",defaultMessage:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"})}]})]}),(0,r.jsxs)("div",{style:{marginBottom:24},children:[(0,r.jsx)(w,{noStyle:!0,name:"autoLogin",children:(0,r.jsx)(k.FormattedMessage,{id:"pages.login.rememberMe",defaultMessage:"\u81EA\u52A8\u767B\u5F55"})}),(0,r.jsx)("a",{style:{float:"right"},onClick:()=>{p.info(m.formatMessage({id:"pages.login.forgotPassword.contactAdmin",defaultMessage:""}));},children:(0,r.jsx)(k.FormattedMessage,{id:"pages.login.forgotPassword",defaultMessage:"\u9ED8\u8BA4\u7528\u6237\u540Dadmi,\u9ED8\u8BA4\u5BC6\u7801123456\uFF0C\u767B\u5F55\u540E\u8BF7\u4FEE\u6539"})}),"account"===i&&(0,r.jsx)("a",{style:{float:"right",paddingRight:10},onClick:()=>{k.history.push("/register");}})]})]})}),(0,r.jsx)(N.Footer,{})]});};},a8e90e34:function(e,a,t){"use strict";t.d(a,"__esModule",{value:!0}),t.d(a,"API",{enumerable:!0,get:function(){return l;}});var s=t("777fffbe")._(t("795f1363")),o=t("1fc97d93"),r=t("9a7ec01c"),i=t("23f8e02c");let l=s.default.create({baseURL:r.ENV.API_BASE_URL});l.interceptors.request.use(e=>{let a=(0,i.authHeader)();return e.headers&&"function"==typeof e.headers.set?a.Authorization&&e.headers.set("Authorization",a.Authorization):e.headers&&a.Authorization&&(e.headers.Authorization=a.Authorization),e;},e=>Promise.reject(e)),l.interceptors.response.use(e=>e,e=>((0,o.showError)(e),Promise.reject(e)));}}]);
//# sourceMappingURL=49fa7062-async.39a67e8a.js.map