(("undefined"!=typeof globalThis?globalThis:self)["makoChunk_ant-design-pro"]=("undefined"!=typeof globalThis?globalThis:self)["makoChunk_ant-design-pro"]||[]).push([["22f01caa"],{a8e90e34:function(e,a,s){"use strict";s.d(a,"__esModule",{value:!0}),s.d(a,"API",{enumerable:!0,get:function(){return d;}});var l=s("777fffbe")._(s("795f1363")),r=s("1fc97d93"),i=s("9a7ec01c"),t=s("23f8e02c");let d=l.default.create({baseURL:i.ENV.API_BASE_URL});d.interceptors.request.use(e=>{let a=(0,t.authHeader)();return e.headers&&"function"==typeof e.headers.set?a.Authorization&&e.headers.set("Authorization",a.Authorization):e.headers&&a.Authorization&&(e.headers.Authorization=a.Authorization),e;},e=>Promise.reject(e)),d.interceptors.response.use(e=>e,e=>((0,r.showError)(e),Promise.reject(e)));},e4c4b698:function(e,a,s){s.d(a,"__esModule",{value:!0}),s.e(a,{default:function(){return D;}});var l=s("777fffbe"),r=s("852bbaa9"),i=s("26e051b7"),t=s("76b52bba"),d=r._(t),o=s("ae74910a"),n=s("985b35bf"),c=s("7e008f03"),p=l._(c),u=s("e081a98a"),m=l._(u),g=s("dc9ef55b"),f=l._(g),x=s("78d99ba6"),h=l._(x),v=s("e27282e4"),M=l._(v);let j=(e,a)=>{switch(e){case"active":return a.formatMessage({id:"pages.admin.providerCard.status.active",defaultMessage:"\u6D3B\u8DC3"});case"inactive":return a.formatMessage({id:"pages.admin.providerCard.status.inactive",defaultMessage:"\u79BB\u7EBF"});case"error":return a.formatMessage({id:"pages.admin.providerCard.status.error",defaultMessage:"\u9519\u8BEF"});default:return a.formatMessage({id:"pages.admin.providerCard.status.unknown",defaultMessage:"\u672A\u77E5"});}},b=e=>{switch(e){case"ASR":return"\u{1F3A4}";case"TTS":return"\u{1F50A}";case"LLM":return"\u{1F916}";case"VLLLM":return"\u{1F441}\uFE0F";default:return"\u2699\uFE0F";}};function y({provider:e,onEdit:a,onDelete:s,onTest:l,onToggleStatus:r,canEditAdmin:t}){let c=(0,o.useIntl)(),[u,g]=(0,d.useState)(!1),[x,v]=(0,d.useState)(null),y=async()=>{if(!t){M.default.warning(c.formatMessage({id:"pages.admin.providerCard.warning.readonly.test",defaultMessage:"\u53EA\u8BFB\u6743\u9650\uFF0C\u65E0\u6CD5\u6D4B\u8BD5\u4F9B\u5E94\u5546"}));return;}g(!0),v(null);try{await l(e);}catch(e){v({success:!1,message:e instanceof Error?e.message:c.formatMessage({id:"pages.admin.providerCard.test.failed",defaultMessage:"\u6D4B\u8BD5\u5931\u8D25"})});}finally{g(!1);}},_=()=>{if(!t){M.default.warning(c.formatMessage({id:"pages.admin.providerCard.warning.readonly.delete",defaultMessage:"\u53EA\u8BFB\u6743\u9650\uFF0C\u65E0\u6CD5\u5220\u9664\u4F9B\u5E94\u5546"}));return;}f.default.confirm({title:c.formatMessage({id:"pages.admin.providerCard.delete.title",defaultMessage:"\u786E\u5B9A\u8981\u5220\u9664\u6B64\u9879\u5417\uFF1F"}),content:c.formatMessage({id:"pages.admin.providerCard.delete.content",defaultMessage:"\u5220\u9664\u540E\u65E0\u6CD5\u6062\u590D\uFF0C\u8BF7\u786E\u8BA4\u64CD\u4F5C\u3002"}),okType:"danger",onOk:()=>{s(e);},onCancel(){}});},N=[(0,i.jsx)("div",{style:{padding:15},children:(0,i.jsxs)("div",{children:[(0,i.jsx)(p.default,{onClick:a=>{if(a.stopPropagation(),!t){M.default.warning(c.formatMessage({id:"pages.admin.providerCard.warning.readonly.toggle",defaultMessage:"\u53EA\u8BFB\u6743\u9650\uFF0C\u65E0\u6CD5\u5207\u6362\u72B6\u6001"}));return;}r(e);},title:"active"===e.status?c.formatMessage({id:"pages.admin.providerCard.button.disable",defaultMessage:"\u7981\u7528"}):c.formatMessage({id:"pages.admin.providerCard.button.enable",defaultMessage:"\u542F\u7528"}),disabled:!0,children:"active"===e.status?c.formatMessage({id:"pages.admin.providerCard.button.disable",defaultMessage:"\u7981\u7528"}):c.formatMessage({id:"pages.admin.providerCard.button.enable",defaultMessage:"\u542F\u7528"})}),(0,i.jsx)(p.default,{onClick:e=>{if(e.stopPropagation(),!t){M.default.warning(c.formatMessage({id:"pages.admin.providerCard.warning.readonly.test",defaultMessage:"\u53EA\u8BFB\u6743\u9650\uFF0C\u65E0\u6CD5\u6D4B\u8BD5\u4F9B\u5E94\u5546"}));return;}y();},disabled:!0,children:u?c.formatMessage({id:"pages.admin.providerCard.button.testing",defaultMessage:"\u6D4B\u8BD5\u4E2D..."}):c.formatMessage({id:"pages.admin.providerCard.button.test",defaultMessage:"\u6D4B\u8BD5"})}),(0,i.jsx)(p.default,{onClick:s=>{if(s.stopPropagation(),!t){M.default.warning(c.formatMessage({id:"pages.admin.providerCard.warning.readonly.edit",defaultMessage:"\u53EA\u8BFB\u6743\u9650\uFF0C\u65E0\u6CD5\u7F16\u8F91\u4F9B\u5E94\u5546"}));return;}a(e);},disabled:!t,children:c.formatMessage({id:"pages.admin.providerCard.button.edit",defaultMessage:"\u7F16\u8F91"})}),(0,i.jsx)(p.default,{danger:!0,onClick:e=>{if(e.stopPropagation(),!t){M.default.warning(c.formatMessage({id:"pages.admin.providerCard.warning.readonly.delete",defaultMessage:"\u53EA\u8BFB\u6743\u9650\uFF0C\u65E0\u6CD5\u5220\u9664\u4F9B\u5E94\u5546"}));return;}_();},disabled:!t,children:c.formatMessage({id:"pages.admin.providerCard.button.delete",defaultMessage:"\u5220\u9664"})})]})})];return(0,i.jsxs)(n.ProCard,{style:{maxWidth:350,margin:10,cursor:t?"pointer":"default",padding:12},actions:N,hoverable:!0,onClick:()=>{if(!t){M.default.warning(c.formatMessage({id:"pages.admin.providerCard.warning.readonly.edit",defaultMessage:"\u53EA\u8BFB\u6743\u9650\uFF0C\u65E0\u6CD5\u7F16\u8F91\u4F9B\u5E94\u5546"}));return;}a(e);},children:[(0,i.jsxs)(h.default,{justify:"space-between",align:"middle",style:{width:"100%"},children:[(0,i.jsx)(m.default,{children:(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,i.jsx)("div",{style:{width:40,height:40,borderRadius:8,background:"#f3f4f6",display:"flex",alignItems:"center",justifyContent:"center",fontSize:18},children:b(e.type)}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontWeight:700,fontSize:14,lineHeight:"16px"},children:e.name}),e.config.type&&(0,i.jsxs)("div",{style:{fontSize:12,color:"#6b7280",marginTop:4},children:[c.formatMessage({id:"pages.admin.providerCard.config.type",defaultMessage:"\u7C7B\u578B"}),": ",e.config.type]})]})]})}),(0,i.jsx)(m.default,{children:(0,i.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end"},children:(0,i.jsx)("span",{style:{fontSize:12,color:"active"===e.status?"#10b981":"inactive"===e.status?"#f59e0b":"#ef4444",fontWeight:600},children:j(e.status,c)})})})]}),(0,i.jsxs)("div",{style:{marginTop:8},children:[("LLM"===e.type||"VLLLM"===e.type)&&(0,i.jsxs)(i.Fragment,{children:[e.config.url&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("span",{children:[c.formatMessage({id:"pages.admin.providerCard.config.apiUrl",defaultMessage:"API\u5730\u5740"}),"\uFF1A"]}),(0,i.jsx)("span",{children:e.config.url})]}),e.config.model_name&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("span",{children:[c.formatMessage({id:"pages.admin.providerCard.config.model",defaultMessage:"\u6A21\u578B"}),"\uFF1A"]}),(0,i.jsx)("span",{children:e.config.model_name})]}),e.config.api_key&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("span",{children:[c.formatMessage({id:"pages.admin.providerCard.config.apiKey",defaultMessage:"API\u5BC6\u94A5"}),"\uFF1A"]}),(0,i.jsxs)("span",{children:[e.config.api_key.slice(0,8),"..."]})]}),void 0!==e.config.temperature&&0!==e.config.temperature&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("span",{children:[c.formatMessage({id:"pages.admin.providerCard.config.temperature",defaultMessage:"\u6E29\u5EA6"}),"\uFF1A"]}),(0,i.jsx)("span",{children:e.config.temperature})]}),void 0!==e.config.max_tokens&&e.config.max_tokens>0&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("span",{children:[c.formatMessage({id:"pages.admin.providerCard.config.maxTokens",defaultMessage:"\u6700\u5927tokens"}),"\uFF1A"]}),(0,i.jsx)("span",{children:e.config.max_tokens})]})]}),"ASR"===e.type&&(0,i.jsxs)(i.Fragment,{children:["doubao"===e.config.type&&(0,i.jsxs)(i.Fragment,{children:[e.config.appid&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("span",{children:[c.formatMessage({id:"pages.admin.providerCard.config.appid",defaultMessage:"\u5E94\u7528ID"}),"\uFF1A"]}),(0,i.jsx)("span",{children:e.config.appid})]}),e.config.cluster&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("span",{children:[c.formatMessage({id:"pages.admin.providerCard.config.cluster",defaultMessage:"\u96C6\u7FA4"}),"\uFF1A"]}),(0,i.jsx)("span",{style:{wordBreak:"break-all"},children:e.config.cluster})]}),e.config.access_token&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("span",{children:[c.formatMessage({id:"pages.admin.providerCard.config.accessToken",defaultMessage:"\u8BBF\u95EE\u4EE4\u724C"}),"\uFF1A"]}),(0,i.jsxs)("span",{children:[e.config.access_token.slice(0,8),"..."]})]})]}),"grpc"===e.config.type&&(0,i.jsxs)(i.Fragment,{children:[e.config.grpc_host&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("span",{children:[c.formatMessage({id:"pages.admin.providerCard.config.grpcHost",defaultMessage:"gRPC\u4E3B\u673A"}),"\uFF1A"]}),(0,i.jsx)("span",{children:e.config.grpc_host})]}),e.config.grpc_port&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("span",{children:[c.formatMessage({id:"pages.admin.providerCard.config.grpcPort",defaultMessage:"gRPC\u7AEF\u53E3"}),"\uFF1A"]}),(0,i.jsx)("span",{children:e.config.grpc_port})]})]}),"gosherpa"===e.config.type&&(0,i.jsx)(i.Fragment,{children:e.config.gosherpa_model&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("span",{children:[c.formatMessage({id:"pages.admin.providerCard.config.model",defaultMessage:"\u6A21\u578B"}),"\uFF1A"]}),(0,i.jsx)("span",{children:e.config.gosherpa_model})]})})]}),"TTS"===e.type&&(0,i.jsxs)(i.Fragment,{children:[e.config.voice&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("span",{children:[c.formatMessage({id:"pages.admin.providerCard.config.voice",defaultMessage:"\u8BED\u97F3"}),"\uFF1A"]}),(0,i.jsx)("span",{children:e.config.voice})]}),e.config.format&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("span",{children:[c.formatMessage({id:"pages.admin.providerCard.config.format",defaultMessage:"\u683C\u5F0F"}),"\uFF1A"]}),(0,i.jsx)("span",{children:e.config.format})]}),"doubao"===e.config.type&&(0,i.jsxs)(i.Fragment,{children:[e.config.appid&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("span",{children:[c.formatMessage({id:"pages.admin.providerCard.config.appid",defaultMessage:"\u5E94\u7528ID"}),"\uFF1A"]}),(0,i.jsx)("span",{children:e.config.appid})]}),e.config.token&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("span",{children:[c.formatMessage({id:"pages.admin.providerCard.config.token",defaultMessage:"\u4EE4\u724C"}),"\uFF1A"]}),(0,i.jsxs)("span",{children:[e.config.token.slice(0,8),"..."]})]})]}),"siliconflowcosyvoice"===e.config.type&&(0,i.jsxs)(i.Fragment,{children:[e.config.siliconflow_api_key&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("span",{children:[c.formatMessage({id:"pages.admin.providerCard.config.apiKey",defaultMessage:"API\u5BC6\u94A5"}),"\uFF1A"]}),(0,i.jsxs)("span",{children:[e.config.siliconflow_api_key.slice(0,8),"..."]})]}),e.config.siliconflow_base_url&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("span",{children:[c.formatMessage({id:"pages.admin.providerCard.config.apiUrl",defaultMessage:"API\u5730\u5740"}),"\uFF1A"]}),(0,i.jsx)("span",{children:e.config.siliconflow_base_url})]})]}),"gosherpa"===e.config.type&&(0,i.jsx)(i.Fragment,{children:e.config.gosherpa_model&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("span",{children:[c.formatMessage({id:"pages.admin.providerCard.config.model",defaultMessage:"\u6A21\u578B"}),"\uFF1A"]}),(0,i.jsx)("span",{children:e.config.gosherpa_model})]})})]}),e.config.output_dir&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("span",{children:[c.formatMessage({id:"pages.admin.providerCard.config.outputDir",defaultMessage:"\u8F93\u51FA\u76EE\u5F55"}),"\uFF1A"]}),(0,i.jsx)("span",{children:e.config.output_dir})]})]}),"TTS"===e.type&&(()=>{let a=e.config&&(e.config.supported_voices||e.config.supportedVoices)||null,s=Array.isArray(a)?a.length:0;return(0,i.jsx)("div",{className:"mt-3",children:(0,i.jsxs)("div",{className:"text-sm text-base-content/70",children:[c.formatMessage({id:"pages.admin.providerCard.voices.supported",defaultMessage:"\u652F\u6301\u7684\u8BED\u97F3"})," (",s," ",c.formatMessage({id:"pages.admin.providerCard.voices.count",defaultMessage:"\u4E2A"}),")"]})});})(),x&&(0,i.jsx)("div",{className:`alert ${x.success?"alert-success":"alert-error"} alert-sm mt-3`,children:(0,i.jsx)("span",{className:"text-xs",children:x.message})})]});}let _={ASR:[{value:"doubao",label:"\u8C46\u5305\u8BED\u97F3\u8BC6\u522B"},{value:"gosherpa",label:"GoSherpa ASR"},{value:"grpc",label:"gRPC ASR"}],LLM:[{value:"openai",label:"OpenAI"},{value:"ollama",label:"Ollama"},{value:"dify",label:"Dify"}],TTS:[{value:"doubao",label:"\u8C46\u5305\u8BED\u97F3\u5408\u6210"},{value:"edge",label:"Microsoft Edge TTS"},{value:"gosherpa",label:"GoSherpa TTS"},{value:"siliconflowcosyvoice",label:"SiliconFlow CosyVoice"}],VLLLM:[{value:"ollama",label:"Ollama"},{value:"openai",label:"OpenAI Vision"}]},N={ASR:{doubao:{type:"doubao",appid:"",access_token:"",cluster:"volcengine_streaming_common",output_dir:"./output/asr"},gosherpa:{type:"gosherpa",gosherpa_model:"",output_dir:"./output/asr"},grpc:{type:"grpc",grpc_host:"localhost",grpc_port:50051,output_dir:"./output/asr"}},LLM:{openai:{type:"openai",model_name:"gpt-3.5-turbo",url:"https://api.openai.com/v1",api_key:"",temperature:.7,max_tokens:2048,top_p:1,extra:{}},ollama:{type:"ollama",model_name:"llama2",url:"http://localhost:11434/v1",api_key:"ollama",temperature:.7,max_tokens:2048,top_p:1,extra:{}},dify:{type:"dify",url:"https://testagent.dify.com/v1",api_key:"dify",extra:{}}},TTS:{doubao:{type:"doubao",voice:"BV001_streaming",format:"mp3",output_dir:"./output/tts",appid:"",token:"",cluster:"volcano_tts",supportedVoices:null},edge:{type:"edge",voice:"zh-CN-XiaoxiaoNeural",format:"mp3",output_dir:"./output/tts",edge_voice:"zh-CN-XiaoxiaoNeural",supportedVoices:null},gosherpa:{type:"gosherpa",voice:"default",format:"wav",output_dir:"./output/tts",cluster:"ws://127.0.0.1:8848/tts",supportedVoices:null},siliconflowcosyvoice:{type:"siliconflowcosyvoice",voice:"default",format:"mp3",output_dir:"./output/tts",siliconflow_api_key:"",siliconflow_base_url:"https://api.siliconflow.cn/v1",supportedVoices:null}},VLLLM:{ollama:{type:"ollama",model_name:"llava",url:"http://localhost:11434/v1",api_key:"ollama",temperature:.7,max_tokens:2048,top_p:1,extra:{},security:{max_file_size:10485760,max_pixels:2073600,max_width:2048,max_height:2048,allowed_formats:["jpg","jpeg","png","gif","webp","bmp"],enable_deep_scan:!0,validation_timeout:"30s"}},openai:{type:"openai",model_name:"gpt-4-vision-preview",url:"https://api.openai.com/v1",api_key:"",temperature:.7,max_tokens:2048,top_p:1,extra:{},security:{max_file_size:20971520,max_pixels:2073600,max_width:2048,max_height:2048,allowed_formats:["jpg","jpeg","png","gif","webp"],enable_deep_scan:!0,validation_timeout:"30s"}}}};var C=s("6a64c6d6"),k=l._(C),w=s("8f49028c"),L=l._(w),S=s("accfd539"),T=l._(S),A=s("c549e0ea"),P=l._(A),I=s("dea4190d"),O=l._(I);function V({open:e,initialVoices:a,onClose:s,onSave:l}){let[r,t]=(0,d.useState)(a?a.slice():[]),[o,n]=(0,d.useState)(!1),[c,u]=(0,d.useState)(null),[m,g]=(0,d.useState)({name:"",display_name:"",sex:"",description:"",audio_url:"",language:""}),[x,h]=(0,d.useState)(!1),[v,j]=(0,d.useState)("");(0,d.useEffect)(()=>{t(a?a.slice():[]);},[a,e]);let b=e=>{u(e),g({...r[e],language:r[e].language??""}),n(!0);},y=e=>{let a=r.slice();a.splice(e,1),t(a),M.default.success("\u5DF2\u5220\u9664\u97F3\u8272");},_=e=>e.name&&e.name.trim()?!!(e.display_name&&e.display_name.trim())||(M.default.error("display_name \u4E3A\u5FC5\u586B\u9879"),!1):(M.default.error("name \u4E3A\u5FC5\u586B\u9879"),!1),N=e=>{if(!v.trim()){M.default.error("\u8BF7\u7C98\u8D34 JSON \u6216 YAML \u6570\u7EC4");return;}let a=null;try{a=JSON.parse(v);}catch(e){try{let e=window.YAML;if(e&&"function"==typeof e.parse)a=e.parse(v);else{let e=v;e=(e=(e=(e=e.replace(/#.*$/gm,"")).replace(/'([^']*)'/g,function(e,a){return'"'+a.replace(/"/g,'\\"')+'"';})).replace(/([{,]\s*)([a-zA-Z0-9_+-]+)\s*:/g,'$1"$2":')).replace(/,(\s*[}\]])/g,"$1"),a=JSON.parse(e);}}catch(a){console.error(e,a),M.default.error("\u89E3\u6790\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5 JSON/YAML \u683C\u5F0F");return;}}if(!Array.isArray(a)){M.default.error("\u5BFC\u5165\u683C\u5F0F\u5E94\u4E3A\u6570\u7EC4\uFF08JSON \u6216 YAML\uFF09");return;}let s=a.map(e=>({name:String(e.name||0===e.name?e.name:""),display_name:e.display_name||e.displayName||e.display||"",sex:e.sex||"",description:e.description||"",audio_url:e.audio_url||e.audioUrl||e.audio||"",language:e.language||""}));t(e?s:[...r,...s]),h(!1),j(""),M.default.success(`\u{6210}\u{529F}\u{5BFC}\u{5165} ${s.length} \u{6761}\u{97F3}\u{8272}`);};return(0,i.jsxs)(P.default,{title:"\u7BA1\u7406\u97F3\u8272",width:720,onClose:s,open:e,destroyOnHidden:!0,footer:(0,i.jsx)("div",{style:{textAlign:"right"},children:(0,i.jsxs)(T.default,{children:[(0,i.jsx)(p.default,{onClick:()=>{h(!0);},children:"\u5BFC\u5165 JSON/YAML"}),(0,i.jsx)(p.default,{onClick:()=>{t([]),M.default.success("\u5DF2\u6E05\u7A7A\u97F3\u8272\u5217\u8868");},children:"\u6E05\u7A7A"}),(0,i.jsx)(p.default,{type:"primary",onClick:()=>{l(r),s(),M.default.success("\u5DF2\u4FDD\u5B58\u97F3\u8272\u5217\u8868");},children:"\u4FDD\u5B58\u5E76\u5173\u95ED"})]})}),children:[(0,i.jsxs)(T.default,{style:{marginBottom:12},children:[(0,i.jsx)(p.default,{type:"primary",onClick:()=>{u(null),g({name:"",display_name:"",sex:"",description:"",audio_url:"",language:""}),n(!0);},children:"\u65B0\u589E\u97F3\u8272"}),(0,i.jsx)(p.default,{onClick:()=>{h(!0);},children:"\u7C98\u8D34\u5BFC\u5165 (JSON/YAML)"})]}),(0,i.jsx)(O.default,{bordered:!0,dataSource:r,renderItem:(e,a)=>{var s;return(0,i.jsx)(O.default.Item,{actions:[(0,i.jsx)(p.default,{disabled:!e.audio_url,onClick:()=>{e.audio_url&&new Audio(e.audio_url).play().catch(()=>{window.open(e.audio_url,"_blank");});},children:"\u8BD5\u542C"},"play"),(0,i.jsx)(p.default,{onClick:()=>b(a),children:"\u7F16\u8F91"},"edit"),(0,i.jsx)(p.default,{danger:!0,onClick:()=>y(a),children:"\u5220\u9664"},"del")],children:(0,i.jsx)(O.default.Item.Meta,{title:`${e.display_name||e.name} (${e.name})`,description:(0,i.jsxs)(i.Fragment,{children:[e.description||"-",(0,i.jsx)("br",{}),(0,i.jsxs)("span",{style:{color:"#888"},children:["\u8BED\u79CD\uFF1A",(null===(s=e.language)||void 0===s?void 0:s.trim())?e.language:"\u666E\u901A\u8BDD"]})]})})});}}),(0,i.jsx)(f.default,{title:null!==c?"\u7F16\u8F91\u97F3\u8272":"\u65B0\u589E\u97F3\u8272",open:o,onOk:()=>{if(!_(m))return;let e=r.slice();null!==c&&c>=0?e[c]=m:e.push(m),t(e),n(!1),M.default.success("\u4FDD\u5B58\u6210\u529F");},onCancel:()=>n(!1),destroyOnHidden:!0,children:(0,i.jsxs)("div",{className:"space-y-3",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"label",children:(0,i.jsx)("span",{className:"label-text",children:"\u97F3\u8272id *"})}),(0,i.jsx)(k.default,{value:m.name,onChange:e=>g({...m,name:e.target.value})})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"label",children:(0,i.jsx)("span",{className:"label-text",children:"\u663E\u793A\u540D\u5B57 *"})}),(0,i.jsx)(k.default,{value:m.display_name,onChange:e=>g({...m,display_name:e.target.value})})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"label",children:(0,i.jsx)("span",{className:"label-text",children:"\u6027\u522B"})}),(0,i.jsx)(k.default,{value:m.sex,onChange:e=>g({...m,sex:e.target.value})})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"label",children:(0,i.jsx)("span",{className:"label-text",children:"\u63CF\u8FF0"})}),(0,i.jsx)(k.default.TextArea,{rows:3,value:m.description,onChange:e=>g({...m,description:e.target.value})})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"label",children:(0,i.jsx)("span",{className:"label-text",children:"\u8BD5\u542C\u97F3\u9891\u94FE\u63A5"})}),(0,i.jsx)(k.default,{value:m.audio_url,onChange:e=>g({...m,audio_url:e.target.value})})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"label",children:(0,i.jsx)("span",{className:"label-text",children:"\u8BED\u8A00"})}),(0,i.jsx)(k.default,{value:m.language,onChange:e=>g({...m,language:e.target.value}),placeholder:"\u5982 \u666E\u901A\u8BDD\u3001\u82F1\u8BED\u3001\u7CA4\u8BED\u3001\u65E5\u8BED"})]})]})}),(0,i.jsx)(f.default,{title:"\u5BFC\u5165 JSON/YAML \u6570\u7EC4",open:x,onCancel:()=>h(!1),onOk:()=>N(!1),okText:"\u8FFD\u52A0\u5BFC\u5165",cancelText:"\u53D6\u6D88",destroyOnHidden:!0,children:(0,i.jsxs)("div",{className:"mb-3",children:[(0,i.jsxs)("div",{style:{marginBottom:8,display:"flex",gap:8},children:[(0,i.jsx)(p.default,{onClick:()=>N(!0),children:"\u66FF\u6362\u5168\u90E8\u5E76\u5BFC\u5165"}),(0,i.jsx)(p.default,{onClick:()=>{j(JSON.stringify([{name:"zh-CN-XiaoxiaoNeural",display_name:"\u6653\u6653",sex:"\u5973",description:"\u5546\u52A1\u77E5\u6027\u98CE\u683C\uFF0C\u97F3\u8272\u6210\u719F\u6E05\u6670\uFF0C\u9002\u5408\u65B0\u95FB\u64AD\u62A5\u3001\u4E13\u4E1A\u5185\u5BB9\u6717\u8BFB",audio_url:""},{name:"zh-CN-XiaoyiNeural",display_name:"\u6653\u4F0A",sex:"\u5973",description:"\u67D4\u548C\u6E29\u6696\u98CE\u683C\uFF0C\u5E26\u81EA\u7136\u547C\u5438\u611F\uFF0C\u9002\u5408\u6545\u4E8B\u53D9\u8FF0\u6216\u5BA2\u670D\u573A\u666F",audio_url:""},{name:"zh-CN-YunjianNeural",display_name:"\u4E91\u5065",sex:"\u7537",description:"\u6C89\u7A33\u78C1\u6027\u7537\u58F0\uFF0C\u6743\u5A01\u611F\u5F3A\uFF0C\u9002\u5408\u7537\u6027\u89D2\u8272\u914D\u97F3\u6216\u4E25\u8083\u5185\u5BB9",audio_url:""},{name:"zh-CN-YunxiNeural",display_name:"\u4E91\u5E0C",sex:"\u7537",description:"\u5E74\u8F7B\u6D3B\u529B\u98CE\u683C\uFF0C\u8BED\u901F\u8F7B\u5FEB\uFF0C\u9002\u5408\u9752\u5C11\u5E74\u89D2\u8272\u6216\u8F7B\u677E\u573A\u666F",audio_url:""},{name:"zh-CN-YunxiaNeural",display_name:"\u4E91\u590F",sex:"\u7537",description:"\u65B9\u8A00\u7279\u8272\uFF08\u4E1C\u5317\u8154\uFF09\uFF0C\u5E7D\u9ED8\u63A5\u5730\u6C14\uFF0C\u9002\u5408\u5A31\u4E50\u5185\u5BB9",audio_url:""},{name:"zh-CN-YunyangNeural",display_name:"\u4E91\u626C",sex:"\u7537",description:"\u660E\u4EAE\u81EA\u4FE1\u98CE\u683C\uFF0C\u4E2D\u6C14\u5341\u8DB3\uFF0C\u9002\u5408\u5E7F\u544A\u5BA3\u4F20\u6216\u516C\u5F00\u6F14\u8BB2",audio_url:""},{name:"zh-CN-liaoning-XiaobeiNeural",display_name:"\u6653\u5317\uFF08\u8FBD\u5B81\uFF09",sex:"\u5973",description:"\u5E26\u4E1C\u5317\u65B9\u8A00\u7279\u8272\uFF0C\u4EB2\u5207\u76F4\u7387\uFF0C\u9002\u5408\u5730\u65B9\u5316\u5185\u5BB9",audio_url:""},{name:"zh-CN-shaanxi-XiaoniNeural",display_name:"\u6653\u59AE\uFF08\u9655\u897F\uFF09",sex:"\u5973",description:"\u9655\u897F\u53E3\u97F3\u98CE\u683C\uFF0C\u8D28\u6734\u70ED\u60C5\uFF0C\u9002\u5408\u65B9\u8A00\u6587\u5316\u573A\u666F",audio_url:""}],null,2));},children:"\u52A0\u8F7D\u793A\u4F8B"})]}),(0,i.jsx)(k.default.TextArea,{value:v,onChange:e=>j(e.target.value),rows:10,placeholder:"\u8BF7\u7C98\u8D34 JSON \u6216 YAML \u6570\u7EC4\uFF0C\u683C\u5F0F\u793A\u4F8B\u53EF\u901A\u8FC7\u201C\u52A0\u8F7D\u793A\u4F8B\u201D\u6309\u94AE\u63D2\u5165"})]})})]});}let R=(e,a)=>{var s,l,r,i;if(!a){let a=null===(r=_[e])||void 0===r?void 0:null===(l=r[0])||void 0===l?void 0:l.value;return a&&(null===(i=N[e])||void 0===i?void 0:i[a])||{};}return(null===(s=N[e])||void 0===s?void 0:s[a])||{};};function $({isOpen:e,onClose:a,onSubmit:s,editingProvider:l,onCopy:r,isCopy:t}){var n;let c=(0,o.useIntl)(),[u,m]=(0,d.useState)({name:"",type:"LLM",subType:"openai",config:R("LLM","openai")}),[g,x]=(0,d.useState)(!1),[h,v]=(0,d.useState)({}),[M,j]=(0,d.useState)(!1),b=[{value:"ASR",label:c.formatMessage({id:"pages.admin.providers.filter.asr",defaultMessage:"ASR - \u8BED\u97F3\u8BC6\u522B"})},{value:"TTS",label:c.formatMessage({id:"pages.admin.providers.filter.tts",defaultMessage:"TTS - \u8BED\u97F3\u5408\u6210"})},{value:"LLM",label:c.formatMessage({id:"pages.admin.providers.filter.llm",defaultMessage:"LLM - \u5927\u8BED\u8A00\u6A21\u578B"})},{value:"VLLLM",label:c.formatMessage({id:"pages.admin.providers.filter.vlllm",defaultMessage:"VLLLM - \u89C6\u89C9\u8BED\u8A00\u6A21\u578B"})}];(0,d.useEffect)(()=>{if(l){let e=l.config.type||("LLM"===l.type?"openai":"ASR"===l.type?"doubao":"TTS"===l.type?"doubao":(l.type,"openai")),a={...l.config};a.url=a.url||a.endpoint||a.base_url||a.siliconflow_base_url||"",a.model_name=a.model_name||a.model||"",a.api_key=a.api_key||a.apiKey||"",a.access_token=a.access_token||a.accessToken||"",a.token=a.token||"",a.max_tokens=a.max_tokens||a.maxTokens||"",a.top_p=a.top_p||a.topP||"",m({name:l.name,type:l.type,subType:e,config:a});}else{let e="openai";m({name:"",type:"LLM",subType:e,config:R("LLM",e)});}v({});},[l,e]);let y=e=>{var a,s;let l=(null===(s=_[e])||void 0===s?void 0:null===(a=s[0])||void 0===a?void 0:a.value)||"openai";m(a=>({...a,type:e,subType:l,config:R(e,l)}));},N=e=>{m(a=>({...a,subType:e,config:R(a.type,e)}));},C=(e,a)=>{m(s=>({...s,config:{...s.config,[e]:a}}));},w=()=>{var e,a,s,l,r,i,t,d,o,n,p,m,g;let f={};u.name.trim()||(f.name=c.formatMessage({id:"pages.admin.providerModal.name.required",defaultMessage:"\u8BF7\u8F93\u5165\u4F9B\u5E94\u5546\u540D\u79F0"}));let{type:x,subType:h,config:M}=u;if(h||(f.subType=c.formatMessage({id:"pages.admin.providerModal.subType.required",defaultMessage:"\u8BF7\u9009\u62E9\u5177\u4F53\u7C7B\u578B"})),("LLM"===x||"VLLLM"===x)&&((null===(e=M.url)||void 0===e?void 0:e.trim())||(f.url=c.formatMessage({id:"pages.admin.providerModal.api.url.required",defaultMessage:"\u8BF7\u8F93\u5165API\u5730\u5740"})),"openai"!==h&&"dify"!==h||(null===(a=M.api_key)||void 0===a?void 0:a.trim())||(f.api_key=c.formatMessage({id:"pages.admin.providerModal.api.key.required",defaultMessage:"\u8BF7\u8F93\u5165API\u5BC6\u94A5"})),"dify"!==h)){if((null===(s=M.model_name)||void 0===s?void 0:s.trim())||(f.model_name=c.formatMessage({id:"pages.admin.providerModal.model.name.required",defaultMessage:"\u8BF7\u8F93\u5165\u6A21\u578B\u540D\u79F0"})),void 0!==M.temperature){let e=Number(M.temperature);(isNaN(e)||e<0||e>2)&&(f.temperature=c.formatMessage({id:"pages.admin.providerModal.temperature.error",defaultMessage:"\u6E29\u5EA6\u503C\u5E94\u57280-2\u4E4B\u95F4"}));}if(void 0!==M.max_tokens){let e=Number(M.max_tokens);(isNaN(e)||e<1||e>32768)&&(f.max_tokens=c.formatMessage({id:"pages.admin.providerModal.maxTokens.error",defaultMessage:"\u6700\u5927\u4EE4\u724C\u6570\u5E94\u57281-32768\u4E4B\u95F4"}));}}return"ASR"!==x||("doubao"===h?((null===(l=M.appid)||void 0===l?void 0:l.trim())||(f.appid=c.formatMessage({id:"pages.admin.providerModal.appid.required",defaultMessage:"\u8BF7\u8F93\u5165\u5E94\u7528ID"})),(null===(r=M.access_token)||void 0===r?void 0:r.trim())||(f.access_token=c.formatMessage({id:"pages.admin.providerModal.accessToken.required",defaultMessage:"\u8BF7\u8F93\u5165\u8BBF\u95EE\u4EE4\u724C"}))):"grpc"===h?((null===(i=M.grpc_host)||void 0===i?void 0:i.trim())||(f.grpc_host=c.formatMessage({id:"pages.admin.providerModal.grpc.host.required",defaultMessage:"\u8BF7\u8F93\u5165gRPC\u4E3B\u673A\u5730\u5740"})),M.grpc_port||(f.grpc_port=c.formatMessage({id:"pages.admin.providerModal.grpc.port.required",defaultMessage:"\u8BF7\u8F93\u5165gRPC\u7AEF\u53E3"}))):"gosherpa"!==h||(null===(t=M.gosherpa_model)||void 0===t?void 0:t.trim())||(f.gosherpa_model=c.formatMessage({id:"pages.admin.providerModal.gosherpa.model.required",defaultMessage:"\u8BF7\u8F93\u5165\u6A21\u578B\u540D\u79F0"}))),"TTS"!==x||((null===(d=M.voice)||void 0===d?void 0:d.trim())||(f.voice=c.formatMessage({id:"pages.admin.providerModal.voice.required",defaultMessage:"\u8BF7\u8F93\u5165\u8BED\u97F3\u7C7B\u578B"})),"doubao"===h?((null===(o=M.appid)||void 0===o?void 0:o.trim())||(f.appid=c.formatMessage({id:"pages.admin.providerModal.appid.required",defaultMessage:"\u8BF7\u8F93\u5165\u5E94\u7528ID"})),(null===(n=M.token)||void 0===n?void 0:n.trim())||(f.token=c.formatMessage({id:"pages.admin.providerModal.token.required",defaultMessage:"\u8BF7\u8F93\u5165\u4EE4\u724C"}))):"siliconflowcosyvoice"===h?((null===(p=M.siliconflow_api_key)||void 0===p?void 0:p.trim())||(f.siliconflow_api_key=c.formatMessage({id:"pages.admin.providerModal.siliconflow.apiKey.required",defaultMessage:"\u8BF7\u8F93\u5165API\u5BC6\u94A5"})),(null===(m=M.siliconflow_base_url)||void 0===m?void 0:m.trim())||(f.siliconflow_base_url=c.formatMessage({id:"pages.admin.providerModal.api.url.required",defaultMessage:"\u8BF7\u8F93\u5165API\u5730\u5740"}))):"gosherpa"!==h||(null===(g=M.cluster)||void 0===g?void 0:g.trim())||(f.cluster=c.formatMessage({id:"pages.admin.providerModal.websocket.required",defaultMessage:"\u8BF7\u8F93\u5165WebSocket\u5730\u5740"}))),v(f),0===Object.keys(f).length;},S=async e=>{if(e.preventDefault(),w()){x(!0);try{let e=Object.fromEntries(Object.entries(u.config).filter(([e,a])=>""!==a&&null!=a)),l=e.url||e.endpoint||e.base_url||e.siliconflow_base_url||"";await s({...u,config:{...e,url:l,type:u.subType}}),a();}catch(e){console.error("\u63D0\u4EA4\u5931\u8D25:",e),v({submit:e instanceof Error?e.message:c.formatMessage({id:"pages.admin.providerModal.submit.error",defaultMessage:"\u63D0\u4EA4\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"})});}finally{x(!1);}}};return e?(0,i.jsxs)(f.default,{open:!0,onCancel:a,title:l&&l.name?c.formatMessage({id:"pages.admin.providerModal.edit.title",defaultMessage:"\u7F16\u8F91\u4F9B\u5E94\u5546"}):c.formatMessage({id:"pages.admin.providerModal.add.title",defaultMessage:"\u6DFB\u52A0\u65B0\u4F9B\u5E94\u5546"}),onOk:S,footer:(0,i.jsxs)(T.default,{children:[l&&l.name&&r&&(0,i.jsx)(p.default,{type:"default",onClick:r,children:"\u590D\u5236\u4E3A\u65B0\u7684\u4F9B\u5E94\u5546"}),(0,i.jsx)(p.default,{onClick:a,children:"\u53D6\u6D88"}),(0,i.jsx)(p.default,{type:"primary",onClick:S,loading:g,children:c.formatMessage({id:"pages.admin.providerModal.save",defaultMessage:"\u4FDD\u5B58"})})]}),children:[(0,i.jsx)("div",{className:"modal-box w-11/12 max-w-3xl max-h-[90vh] overflow-y-auto",children:(0,i.jsxs)("form",{onSubmit:S,className:"space-y-6",children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"form-control",children:[(0,i.jsx)("label",{className:"label",children:(0,i.jsx)("span",{className:"label-text",children:c.formatMessage({id:"pages.admin.providerModal.name.label",defaultMessage:"\u4F9B\u5E94\u5546\u540D\u79F0 *"})})}),(0,i.jsx)(k.default,{type:"text",className:`input input-bordered ${h.name?"input-error":""}`,value:u.name,onChange:e=>m(a=>({...a,name:e.target.value})),placeholder:c.formatMessage({id:"pages.admin.providerModal.name.placeholder",defaultMessage:"\u4F8B\u5982\uFF1AOpenAI\u3001\u8C46\u5305TTS"}),disabled:!!l&&!t}),h.name&&(0,i.jsx)("div",{className:"mt-1 text-xs",children:(0,i.jsx)("span",{style:{color:"#ff4d4f"},children:h.name})})]}),(0,i.jsxs)("div",{className:"form-control",children:[(0,i.jsx)("label",{className:"label",children:(0,i.jsx)("span",{className:"label-text",children:c.formatMessage({id:"pages.admin.providerModal.type.label",defaultMessage:"\u670D\u52A1\u5206\u7C7B *"})})}),(0,i.jsx)(L.default,{value:u.type,onChange:e=>y(e),disabled:!!l&&!t,children:b.map(e=>(0,i.jsx)(L.default.Option,{value:e.value,children:e.label},e.value))})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:(0,i.jsx)("span",{children:c.formatMessage({id:"pages.admin.providerModal.subType.label",defaultMessage:"\u5177\u4F53\u7C7B\u578B *"})})}),(0,i.jsx)(L.default,{className:`select select-bordered ${h.subType?"input-error":""}`,value:u.subType,onChange:e=>N(e),children:null===(n=_[u.type])||void 0===n?void 0:n.map(e=>(0,i.jsx)(L.default.Option,{value:e.value,children:e.label},e.value))}),h.subType&&(0,i.jsx)("span",{className:"text-error text-xs mt-1",children:h.subType})]}),(0,i.jsx)("div",{className:"divider",children:c.formatMessage({id:"pages.admin.providerModal.config.title",defaultMessage:"\u914D\u7F6E\u4FE1\u606F"})}),(()=>{let{type:e,subType:a,config:s}=u;switch(e){case"LLM":case"VLLLM":return(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"form-control",children:[(0,i.jsx)("label",{className:"label",children:(0,i.jsx)("span",{className:"label-text",children:c.formatMessage({id:"pages.admin.providerModal.api.url.label",defaultMessage:"API\u5730\u5740 *"})})}),(0,i.jsx)(k.default,{type:"url",className:`input input-bordered ${h.url?"input-error":""}`,value:s.url||"",onChange:e=>C("url",e.target.value),placeholder:"openai"===a?"https://api.openai.com/v1":"http://localhost:11434/v1"}),h.url&&(0,i.jsx)("span",{className:"text-error text-xs mt-1",children:h.url})]}),("openai"===a||"ollama"===a)&&(0,i.jsxs)("div",{className:"form-control",children:[(0,i.jsx)("label",{className:"label",children:(0,i.jsx)("span",{className:"label-text",children:c.formatMessage({id:"pages.admin.providerModal.model.name.label",defaultMessage:"\u6A21\u578B\u540D\u79F0 *"})})}),(0,i.jsx)(k.default,{type:"text",className:`input input-bordered ${h.model_name?"input-error":""}`,value:s.model_name||"",onChange:e=>C("model_name",e.target.value),placeholder:"openai"===a?"gpt-3.5-turbo":"llama2"}),h.model_name&&(0,i.jsx)("span",{className:"text-error text-xs mt-1",children:h.model_name})]}),("openai"===a||"dify"===a)&&(0,i.jsxs)("div",{className:"form-control",children:[(0,i.jsx)("label",{className:"label",children:(0,i.jsx)("span",{className:"label-text",children:c.formatMessage({id:"pages.admin.providerModal.api.key.label",defaultMessage:"API\u5BC6\u94A5 *"})})}),(0,i.jsx)(k.default.Password,{className:`input input-bordered ${h.api_key?"input-error":""}`,value:s.api_key||"",onChange:e=>C("api_key",e.target.value),placeholder:"sk-...",visibilityToggle:!0}),h.api_key&&(0,i.jsx)("span",{className:"text-error text-xs mt-1",children:h.api_key})]}),("openai"===a||"ollama"===a)&&(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,i.jsxs)("div",{className:"form-control",children:[(0,i.jsx)("label",{className:"label",children:(0,i.jsx)("span",{className:"label-text",children:c.formatMessage({id:"pages.admin.providerModal.temperature.label",defaultMessage:"\u6E29\u5EA6 (0-2)"})})}),(0,i.jsx)(k.default,{type:"number",step:"0.1",min:"0",max:"2",className:`input input-bordered ${h.temperature?"input-error":""}`,value:s.temperature||"",onChange:e=>C("temperature",Number.parseFloat(e.target.value)||0)}),h.temperature&&(0,i.jsx)("span",{className:"text-error text-xs mt-1",children:h.temperature})]}),(0,i.jsxs)("div",{className:"form-control",children:[(0,i.jsx)("label",{className:"label",children:(0,i.jsx)("span",{className:"label-text",children:c.formatMessage({id:"pages.admin.providerModal.maxTokens.label",defaultMessage:"\u6700\u5927\u4EE4\u724C\u6570"})})}),(0,i.jsx)(k.default,{type:"number",min:"1",max:"32768",className:`input input-bordered ${h.max_tokens?"input-error":""}`,value:s.max_tokens||"",onChange:e=>C("max_tokens",Number.parseInt(e.target.value)||0)}),h.max_tokens&&(0,i.jsx)("span",{className:"text-error text-xs mt-1",children:h.max_tokens})]}),(0,i.jsxs)("div",{className:"form-control",children:[(0,i.jsx)("label",{className:"label",children:(0,i.jsx)("span",{className:"label-text",children:c.formatMessage({id:"pages.admin.providerModal.topP.label",defaultMessage:"Top-P"})})}),(0,i.jsx)(k.default,{type:"number",step:"0.1",min:"0",max:"1",className:"input input-bordered",value:s.top_p||"",onChange:e=>C("top_p",Number.parseFloat(e.target.value)||1)})]})]})]});case"ASR":switch(a){case"doubao":return(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"form-control",children:[(0,i.jsx)("label",{className:"label",children:(0,i.jsx)("span",{className:"label-text",children:c.formatMessage({id:"pages.admin.providerModal.appid.label",defaultMessage:"\u5E94\u7528ID *"})})}),(0,i.jsx)(k.default,{type:"text",className:`input input-bordered ${h.appid?"input-error":""}`,value:s.appid||"",onChange:e=>C("appid",e.target.value),placeholder:c.formatMessage({id:"pages.admin.providerModal.appid.placeholder",defaultMessage:"\u8C46\u5305\u5E94\u7528ID"})}),h.appid&&(0,i.jsx)("span",{className:"text-error text-xs mt-1",children:h.appid})]}),(0,i.jsxs)("div",{className:"form-control",children:[(0,i.jsx)("label",{className:"label",children:(0,i.jsx)("span",{className:"label-text",children:c.formatMessage({id:"pages.admin.providerModal.accessToken.label",defaultMessage:"\u8BBF\u95EE\u4EE4\u724C *"})})}),(0,i.jsx)(k.default.Password,{className:`input input-bordered ${h.access_token?"input-error":""}`,value:s.access_token||"",onChange:e=>C("access_token",e.target.value),placeholder:c.formatMessage({id:"pages.admin.providerModal.accessToken.placeholder",defaultMessage:"\u8C46\u5305\u8BBF\u95EE\u4EE4\u724C"}),visibilityToggle:!0}),h.access_token&&(0,i.jsx)("span",{className:"text-error text-xs mt-1",children:h.access_token})]}),(0,i.jsxs)("div",{className:"form-control",children:[(0,i.jsx)("label",{className:"label",children:(0,i.jsx)("span",{className:"label-text",children:c.formatMessage({id:"pages.admin.providerModal.cluster.label",defaultMessage:"\u96C6\u7FA4"})})}),(0,i.jsx)(k.default,{type:"text",className:"input input-bordered",value:s.cluster||"",onChange:e=>C("cluster",e.target.value),placeholder:"volcengine_streaming_common"})]})]});case"grpc":return(0,i.jsx)("div",{className:"space-y-4",children:(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"form-control",children:[(0,i.jsx)("label",{className:"label",children:(0,i.jsx)("span",{className:"label-text",children:c.formatMessage({id:"pages.admin.providerModal.grpc.host.label",defaultMessage:"gRPC\u4E3B\u673A *"})})}),(0,i.jsx)(k.default,{type:"text",className:`input input-bordered ${h.grpc_host?"input-error":""}`,value:s.grpc_host||"",onChange:e=>C("grpc_host",e.target.value),placeholder:"localhost"}),h.grpc_host&&(0,i.jsx)("span",{className:"text-error text-xs mt-1",children:h.grpc_host})]}),(0,i.jsxs)("div",{className:"form-control",children:[(0,i.jsx)("label",{className:"label",children:(0,i.jsx)("span",{className:"label-text",children:c.formatMessage({id:"pages.admin.providerModal.grpc.port.label",defaultMessage:"gRPC\u7AEF\u53E3 *"})})}),(0,i.jsx)(k.default,{type:"number",className:`input input-bordered ${h.grpc_port?"input-error":""}`,value:s.grpc_port||"",onChange:e=>C("grpc_port",Number.parseInt(e.target.value)||0),placeholder:"50051"}),h.grpc_port&&(0,i.jsx)("span",{className:"text-error text-xs mt-1",children:h.grpc_port})]})]})});case"gosherpa":return(0,i.jsxs)("div",{className:"form-control",children:[(0,i.jsx)("label",{className:"label",children:(0,i.jsx)("span",{className:"label-text",children:c.formatMessage({id:"pages.admin.providerModal.model.name.label",defaultMessage:"\u6A21\u578B\u540D\u79F0 *"})})}),(0,i.jsx)(k.default,{type:"text",className:`input input-bordered ${h.gosherpa_model?"input-error":""}`,value:s.gosherpa_model||"",onChange:e=>C("gosherpa_model",e.target.value),placeholder:c.formatMessage({id:"pages.admin.providerModal.gosherpa.model.placeholder",defaultMessage:"GoSherpa\u6A21\u578B\u540D\u79F0"})}),h.gosherpa_model&&(0,i.jsx)("span",{className:"text-error text-xs mt-1",children:h.gosherpa_model})]});default:return null;}case"TTS":let l=(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"form-control",children:[(0,i.jsx)("label",{className:"label",children:(0,i.jsx)("span",{className:"label-text",children:c.formatMessage({id:"pages.admin.providerModal.voice.label",defaultMessage:"\u97F3\u8272 *"})})}),(0,i.jsx)(k.default,{type:"text",className:`input input-bordered ${h.voice?"input-error":""}`,value:s.voice||"",onChange:e=>C("voice",e.target.value),placeholder:"doubao"===a?"BV001_streaming":"edge"===a?"zh-CN-XiaoxiaoNeural":"default"}),h.voice&&(0,i.jsx)("span",{className:"text-error text-xs mt-1",children:h.voice})]}),(0,i.jsx)("div",{style:{marginTop:8},children:(0,i.jsx)(p.default,{onClick:()=>j(!0),children:c.formatMessage({id:"pages.admin.providerModal.manageVoices",defaultMessage:"\u7BA1\u7406\u97F3\u8272"})})})]});switch(a){case"doubao":return(0,i.jsxs)("div",{className:"space-y-4",children:[l,(0,i.jsxs)("div",{className:"form-control",children:[(0,i.jsx)("label",{className:"label",children:(0,i.jsx)("span",{className:"label-text",children:c.formatMessage({id:"pages.admin.providerModal.appid.label",defaultMessage:"\u5E94\u7528ID *"})})}),(0,i.jsx)(k.default,{type:"text",className:`input input-bordered ${h.appid?"input-error":""}`,value:s.appid||"",onChange:e=>C("appid",e.target.value),placeholder:c.formatMessage({id:"pages.admin.providerModal.appid.placeholder",defaultMessage:"\u8C46\u5305\u5E94\u7528ID"})}),h.appid&&(0,i.jsx)("span",{className:"text-error text-xs mt-1",children:h.appid})]}),(0,i.jsxs)("div",{className:"form-control",children:[(0,i.jsx)("label",{className:"label",children:(0,i.jsx)("span",{className:"label-text",children:c.formatMessage({id:"pages.admin.providerModal.token.label",defaultMessage:"\u4EE4\u724C *"})})}),(0,i.jsx)(k.default.Password,{className:`input input-bordered ${h.token?"input-error":""}`,value:s.token||"",onChange:e=>C("token",e.target.value),placeholder:c.formatMessage({id:"pages.admin.providerModal.token.placeholder",defaultMessage:"\u8C46\u5305\u4EE4\u724C"}),visibilityToggle:!0}),h.token&&(0,i.jsx)("span",{className:"text-error text-xs mt-1",children:h.token})]}),(0,i.jsxs)("div",{className:"form-control",children:[(0,i.jsx)("label",{className:"label",children:(0,i.jsx)("span",{className:"label-text",children:c.formatMessage({id:"pages.admin.providerModal.cluster.label",defaultMessage:"\u96C6\u7FA4"})})}),(0,i.jsx)(k.default,{type:"text",className:"input input-bordered",value:s.cluster||"",onChange:e=>C("cluster",e.target.value),placeholder:"volcano_tts"})]})]});case"edge":return(0,i.jsxs)("div",{className:"space-y-4",children:[l,(0,i.jsx)("div",{className:"alert alert-info",children:(0,i.jsx)("span",{className:"text-sm",children:c.formatMessage({id:"pages.admin.providerModal.edge.noConfig",defaultMessage:"Microsoft Edge TTS \u65E0\u9700\u989D\u5916\u914D\u7F6E"})})})]});case"gosherpa":return(0,i.jsxs)("div",{className:"space-y-4",children:[l,(0,i.jsxs)("div",{className:"form-control",children:[(0,i.jsx)("label",{className:"label",children:(0,i.jsx)("span",{className:"label-text",children:c.formatMessage({id:"pages.admin.providerModal.websocket.label",defaultMessage:"WebSocket\u5730\u5740 *"})})}),(0,i.jsx)(k.default,{type:"text",className:`input input-bordered ${h.cluster?"input-error":""}`,value:s.cluster||"",onChange:e=>C("cluster",e.target.value),placeholder:"ws://127.0.0.1:8848/tts"}),h.cluster&&(0,i.jsx)("span",{className:"text-error text-xs mt-1",children:h.cluster})]})]});case"siliconflowcosyvoice":return(0,i.jsxs)("div",{className:"space-y-4",children:[l,(0,i.jsxs)("div",{className:"form-control",children:[(0,i.jsx)("label",{className:"label",children:(0,i.jsx)("span",{className:"label-text",children:c.formatMessage({id:"pages.admin.providerModal.api.key.label",defaultMessage:"API\u5BC6\u94A5 *"})})}),(0,i.jsx)(k.default.Password,{className:`input input-bordered ${h.siliconflow_api_key?"input-error":""}`,value:s.siliconflow_api_key||"****",onChange:e=>C("siliconflow_api_key",e.target.value),placeholder:c.formatMessage({id:"pages.admin.providerModal.siliconflow.apiKey.placeholder",defaultMessage:"SiliconFlow API\u5BC6\u94A5"}),visibilityToggle:!0}),h.siliconflow_api_key&&(0,i.jsx)("span",{className:"text-error text-xs mt-1",children:h.siliconflow_api_key})]}),(0,i.jsxs)("div",{className:"form-control",children:[(0,i.jsx)("label",{className:"label",children:(0,i.jsx)("span",{className:"label-text",children:c.formatMessage({id:"pages.admin.providerModal.api.url.label",defaultMessage:"API\u5730\u5740"})})}),(0,i.jsx)(k.default,{type:"url",className:`input input-bordered ${h.siliconflow_base_url?"input-error":""}`,value:s.siliconflow_base_url||"",onChange:e=>C("siliconflow_base_url",e.target.value),placeholder:"https://api.siliconflow.cn/v1"}),h.siliconflow_base_url&&(0,i.jsx)("span",{className:"text-error text-xs mt-1",children:h.siliconflow_base_url})]})]});default:return(0,i.jsx)("div",{className:"space-y-4",children:l});}default:return null;}})(),h.submit&&(0,i.jsx)("div",{className:"alert alert-error",children:(0,i.jsx)("span",{children:h.submit})})]})}),(0,i.jsx)(V,{open:M,initialVoices:u.config&&(u.config.supported_voices||u.config.supportedVoices?u.config.supported_voices||(u.config.supportedVoices||[]).map(e=>({name:e,display_name:e})):null),onClose:()=>j(!1),onSave:e=>{m(a=>({...a,config:{...a.config,supported_voices:e,supportedVoices:e?e.map(e=>e.name):null}})),j(!1);}}),(0,i.jsx)("div",{className:"modal-backdrop",onClick:a})]}):null;}var F=s("9acd0375"),z=s("e54bf6aa"),q=s("3ba66d86"),E=l._(q);function D(){var e;let a=(0,o.useIntl)(),s={ASR:a.formatMessage({id:"pages.admin.providers.type.asr",defaultMessage:"ASR - \u8BED\u97F3\u8BC6\u522B"}),TTS:a.formatMessage({id:"pages.admin.providers.type.tts",defaultMessage:"TTS - \u8BED\u97F3\u5408\u6210"}),LLM:a.formatMessage({id:"pages.admin.providers.type.llm",defaultMessage:"LLM - \u5927\u8BED\u8A00\u6A21\u578B"}),VLLLM:a.formatMessage({id:"pages.admin.providers.type.vlllm",defaultMessage:"VLLLM - \u89C6\u89C9\u8BED\u8A00\u6A21\u578B"})},[l,r]=(0,d.useState)([]),[t,c]=(0,d.useState)([]),[u,g]=(0,d.useState)(!0),[f,x]=(0,d.useState)(""),[v,j]=(0,d.useState)("all"),{initialState:b}=(0,o.useModel)("@@initialState");null==b||null===(e=b.currentUser)||void 0===e||e.role;let{canEditProviders:_}=(0,o.useAccess)(),[N,C]=(0,d.useState)(!1),[w,S]=(0,d.useState)(null);(0,d.useEffect)(()=>{A();},[]),(0,d.useEffect)(()=>{let e=l;"all"!==v&&(e=e.filter(e=>e.type===v)),f&&(e=e.filter(e=>{var a,s;return e.name.toLowerCase().includes(f.toLowerCase())||(null===(a=e.config.endpoint)||void 0===a?void 0:a.toLowerCase().includes(f.toLowerCase()))||(null===(s=e.config.model)||void 0===s?void 0:s.toLowerCase().includes(f.toLowerCase()));})),c(e);},[l,f,v]);let A=async()=>{try{g(!0);let e=await F.systemApi.getModelProviders();r(e);}catch(e){console.error("\u52A0\u8F7D\u4F9B\u5E94\u5546\u5217\u8868\u5931\u8D25:",e),M.default.error(a.formatMessage({id:"pages.admin.providers.error.loadFailed",defaultMessage:"\u52A0\u8F7D\u4F9B\u5E94\u5546\u5217\u8868\u5931\u8D25\uFF0C\u8BF7\u5237\u65B0\u9875\u9762\u91CD\u8BD5"}));}finally{g(!1);}},P=()=>{S(null),C(!0);},I=e=>{S(e),C(!0);},[O,V]=(0,d.useState)(!1),R=async e=>{try{O?(await F.systemApi.createModelProvider(e),M.default.success(a.formatMessage({id:"pages.admin.providers.success.created",defaultMessage:"\u4F9B\u5E94\u5546\u6DFB\u52A0\u6210\u529F\uFF01"}))):w?(await F.systemApi.updateModelProviderFromForm(w.type,w.name,e),M.default.success(a.formatMessage({id:"pages.admin.providers.success.updated",defaultMessage:"\u4F9B\u5E94\u5546\u66F4\u65B0\u6210\u529F\uFF01"}))):(await F.systemApi.createModelProvider(e),M.default.success(a.formatMessage({id:"pages.admin.providers.success.created",defaultMessage:"\u4F9B\u5E94\u5546\u6DFB\u52A0\u6210\u529F\uFF01"}))),await A();}catch(i){var s,l;console.error("\u64CD\u4F5C\u5931\u8D25:",i);let e=O||!w?a.formatMessage({id:"pages.admin.providers.error.createFailed",defaultMessage:"\u6DFB\u52A0\u4F9B\u5E94\u5546\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"}):a.formatMessage({id:"pages.admin.providers.error.updateFailed",defaultMessage:"\u66F4\u65B0\u4F9B\u5E94\u5546\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"}),r=(null==i?void 0:null===(l=i.response)||void 0===l?void 0:null===(s=l.data)||void 0===s?void 0:s.message)||e;throw M.default.error(r),i;}},q=(e,a)=>{var s,l;return(null==e?void 0:null===(l=e.response)||void 0===l?void 0:null===(s=l.data)||void 0===s?void 0:s.message)||(null==e?void 0:e.message)||a;},D=async e=>{try{await F.systemApi.deleteModelProvider(e.type,e.name),M.default.success(a.formatMessage({id:"pages.admin.providers.success.deleted",defaultMessage:"\u4F9B\u5E94\u5546\u5220\u9664\u6210\u529F\uFF01"})),await A();}catch(s){console.error("\u5220\u9664\u4F9B\u5E94\u5546\u5931\u8D25:",s);let e=q(s,a.formatMessage({id:"pages.admin.providers.error.deleteFailed",defaultMessage:"\u5220\u9664\u4F9B\u5E94\u5546\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"}));M.default.error(e);}},Y=async e=>{try{let a=await F.systemApi.testModelProvider(e.type,e.name);a.success?M.default.success(a.message):M.default.error(a.message),await A();}catch(s){console.error("\u6D4B\u8BD5\u8FDE\u63A5\u5931\u8D25:",s);let e=q(s,a.formatMessage({id:"pages.admin.providers.error.testFailed",defaultMessage:"\u6D4B\u8BD5\u8FDE\u63A5\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u6216\u914D\u7F6E"}));M.default.error(e);}},J=async e=>{try{await F.systemApi.toggleModelProviderStatus(e.type,e.name),M.default.success(a.formatMessage({id:"pages.admin.providers.success.statusToggled",defaultMessage:"\u72B6\u6001\u5207\u6362\u6210\u529F\uFF01"})),await A();}catch(s){console.error("\u5207\u6362\u72B6\u6001\u5931\u8D25:",s);let e=q(s,a.formatMessage({id:"pages.admin.providers.error.toggleFailed",defaultMessage:"\u5207\u6362\u72B6\u6001\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"}));M.default.error(e);}},X=e=>t.filter(a=>a.type===e);if(u)return(0,i.jsx)(z.PageContainer,{});let B=(()=>{let e={ASR:0,TTS:0,LLM:0,VLLLM:0};return l.forEach(a=>{e[a.type]++;}),e;})();return(0,i.jsx)(z.PageContainer,{children:(0,i.jsxs)("div",{className:"p-6 space-y-6",children:[(0,i.jsx)(n.ProCard,{children:(0,i.jsxs)(T.default,{children:[(0,i.jsx)("div",{children:a.formatMessage({id:"pages.admin.providers.stats",defaultMessage:"ASR: {asr}, TTS: {tts}, LLM: {llm}, VLLLM: {vlllm}"},{total:l.length,asr:B.ASR,tts:B.TTS,llm:B.LLM,vlllm:B.VLLLM})}),(0,i.jsx)(p.default,{type:"primary",icon:(0,i.jsx)(E.default,{}),onClick:P,disabled:!_,children:a.formatMessage({id:"pages.admin.providers.addNew",defaultMessage:"\u6DFB\u52A0\u65B0\u4F9B\u5E94\u5546"})})]})}),(0,i.jsx)(n.ProCard,{style:{marginTop:10},children:(0,i.jsxs)(h.default,{gutter:[16,16],children:[" ",(0,i.jsx)(m.default,{xs:24,sm:24,md:14,children:(0,i.jsx)(k.default,{type:"text",placeholder:a.formatMessage({id:"pages.admin.providers.search.placeholder",defaultMessage:"\u641C\u7D22\u4F9B\u5E94\u5546\u540D\u79F0\u3001\u7AEF\u70B9\u6216\u6A21\u578B..."}),className:"input input-bordered w-full",value:f,onChange:e=>x(e.target.value)})}),(0,i.jsx)(m.default,{xs:24,sm:24,md:10,children:(0,i.jsxs)(L.default,{style:{minWidth:200},className:"select select-bordered",value:v,onChange:e=>j(e),children:[(0,i.jsx)(L.default.Option,{value:"all",children:a.formatMessage({id:"pages.admin.providers.filter.all",defaultMessage:"\u6240\u6709\u7C7B\u578B"})}),(0,i.jsx)(L.default.Option,{value:"ASR",children:a.formatMessage({id:"pages.admin.providers.filter.asr",defaultMessage:"ASR - \u8BED\u97F3\u8BC6\u522B"})}),(0,i.jsx)(L.default.Option,{value:"TTS",children:a.formatMessage({id:"pages.admin.providers.filter.tts",defaultMessage:"TTS - \u8BED\u97F3\u5408\u6210"})}),(0,i.jsx)(L.default.Option,{value:"LLM",children:a.formatMessage({id:"pages.admin.providers.filter.llm",defaultMessage:"LLM - \u5927\u8BED\u8A00\u6A21\u578B"})}),(0,i.jsx)(L.default.Option,{value:"VLLLM",children:a.formatMessage({id:"pages.admin.providers.filter.vlllm",defaultMessage:"VLLLM - \u89C6\u89C9\u8BED\u8A00\u6A21\u578B"})})]})})]})}),0===t.length?(0,i.jsxs)("div",{className:"bg-base-100 rounded shadow p-8 text-center",children:[(0,i.jsx)("div",{className:"text-base-content/50 mb-4",children:(0,i.jsx)("span",{className:"text-4xl",children:"\u{1F4DD}"})}),(0,i.jsx)("h3",{children:0===l.length?a.formatMessage({id:"pages.admin.providers.empty.noProviders",defaultMessage:"\u8FD8\u6CA1\u6709\u4EFB\u4F55\u4F9B\u5E94\u5546"}):a.formatMessage({id:"pages.admin.providers.empty.noMatches",defaultMessage:"\u6CA1\u6709\u627E\u5230\u5339\u914D\u7684\u4F9B\u5E94\u5546"})}),(0,i.jsx)("p",{children:0===l.length?a.formatMessage({id:"pages.admin.providers.empty.addFirst",defaultMessage:"\u70B9\u51FB\u4E0A\u65B9\u6309\u94AE\u6DFB\u52A0\u60A8\u7684\u7B2C\u4E00\u4E2A\u6A21\u578B\u4F9B\u5E94\u5546"}):a.formatMessage({id:"pages.admin.providers.empty.adjustFilters",defaultMessage:"\u5C1D\u8BD5\u8C03\u6574\u641C\u7D22\u6761\u4EF6\u6216\u7B5B\u9009\u5668"})}),0===l.length&&(0,i.jsx)(p.default,{onClick:P,disabled:!_,children:a.formatMessage({id:"pages.admin.providers.addNew",defaultMessage:"\u6DFB\u52A0\u65B0\u4F9B\u5E94\u5546"})})]}):(0,i.jsx)("div",{className:"space-y-6",children:["ASR","TTS","LLM","VLLLM"].map(e=>{let a=X(e);return 0===a.length?null:(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)("h2",{className:"text-lg font-semibold",children:s[e]}),(0,i.jsxs)("div",{className:"badge badge-outline",children:[a.length," \u4E2A"]})]}),(0,i.jsx)(h.default,{gutter:[16,16],children:a.map(e=>(0,i.jsx)(y,{provider:e,onEdit:I,onDelete:D,onTest:Y,onToggleStatus:J,canEditAdmin:_},e.id))})]},e);})}),(0,i.jsx)($,{isOpen:N,onClose:()=>{C(!1),V(!1);},onSubmit:R,editingProvider:w,onCopy:()=>{w&&(S({...w,name:"",id:""}),V(!0),C(!0));},isCopy:O})]})});}}}]);
//# sourceMappingURL=22f01caa-async.5999d7ac.js.map