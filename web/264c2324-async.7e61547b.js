(("undefined"!=typeof globalThis?globalThis:self)["makoChunk_ant-design-pro"]=("undefined"!=typeof globalThis?globalThis:self)["makoChunk_ant-design-pro"]||[]).push([["264c2324"],{a8e90e34:function(e,s,a){"use strict";a.d(s,"__esModule",{value:!0}),a.d(s,"API",{enumerable:!0,get:function(){return r;}});var t=a("777fffbe")._(a("795f1363")),d=a("1fc97d93"),i=a("9a7ec01c"),n=a("23f8e02c");let r=t.default.create({baseURL:i.ENV.API_BASE_URL});r.interceptors.request.use(e=>{let s=(0,n.authHeader)();return e.headers&&"function"==typeof e.headers.set?s.Authorization&&e.headers.set("Authorization",s.Authorization):e.headers&&s.Authorization&&(e.headers.Authorization=s.Authorization),e;},e=>Promise.reject(e)),r.interceptors.response.use(e=>e,e=>((0,d.showError)(e),Promise.reject(e)));},b0be6a32:function(e,s,a){"use strict";a.d(s,"__esModule",{value:!0}),a.d(s,"default",{enumerable:!0,get:function(){return _;}});var t=a("777fffbe"),d=a("26e051b7"),i=a("76b52bba"),n=a("e54bf6aa"),r=t._(a("7201bd80")),l=t._(a("7e008f03")),c=t._(a("3c729238")),o=t._(a("0960755a")),f=t._(a("accfd539")),u=t._(a("78d99ba6")),g=t._(a("e081a98a")),p=t._(a("e27282e4")),m=t._(a("dc9ef55b")),v=t._(a("3ba66d86")),h=t._(a("e00bc7a3")),x=t._(a("c115c636")),M=a("ae74910a"),b=a("9acd0375"),y=a("a8e90e34"),j=t._(a("03015425"));let{Text:A}=o.default;var _=()=>{let[e,s]=(0,i.useState)([]),{agentId:a}=(0,M.useParams)(),t=(0,M.useNavigate)(),o=(0,M.useIntl)(),[_,z]=(0,i.useState)(!1),T=()=>{if(!a){p.default.warning(o.formatMessage({id:"pages.devices.warning.noAgentId",defaultMessage:"\u672A\u6307\u5B9A agentId\uFF0C\u65E0\u6CD5\u83B7\u53D6\u8BBE\u5907\u5217\u8868"})),s([]);return;}b.systemApi.getDeviceListByAgent(a).then(e=>{s((Array.isArray(null==e?void 0:e.data)?e.data:[]).map(e=>({id:e.id,name:e.name||o.formatMessage({id:"pages.devices.device.unnamed",defaultMessage:"\u672A\u547D\u540D\u8BBE\u5907"}),macAddress:e.deviceId,lastActive:e.lastActiveTime?new Date(1e3*e.lastActiveTime).toLocaleString():o.formatMessage({id:"pages.devices.device.noData",defaultMessage:"\u6682\u65E0"}),firmwareVersion:e.version||"",otaEnabled:!!e.ota})));});};(0,i.useEffect)(()=>{T();},[a,o]);let S=e=>{let s=e.split(":");return 6===s.length?`${s[0]}:${s[1]}:**:**:${s[4]}:${s[5]}`:e;},C=e=>{navigator.clipboard.writeText(e),p.default.success(o.formatMessage({id:"pages.devices.copy.success",defaultMessage:"MAC\u5730\u5740\u5DF2\u590D\u5236"}));},k=a=>{let t=e.find(e=>e.id===a);t&&m.default.confirm({title:o.formatMessage({id:"pages.devices.unbind.title",defaultMessage:"\u786E\u8BA4\u89E3\u7ED1\u8BBE\u5907"}),content:o.formatMessage({id:"pages.devices.unbind.content",defaultMessage:"\u8BBE\u5907\u89E3\u7ED1\u540E\u4E0D\u53EF\u6062\u590D\uFF0C\u5982\u9700\u518D\u6B21\u4F7F\u7528\u9700\u91CD\u65B0\u7ED1\u5B9A\u3002\u662F\u5426\u786E\u8BA4\u89E3\u7ED1\uFF1F"}),okText:o.formatMessage({id:"pages.devices.unbind.confirm",defaultMessage:"\u786E\u8BA4\u89E3\u7ED1"}),okType:"danger",cancelText:o.formatMessage({id:"pages.devices.unbind.cancel",defaultMessage:"\u53D6\u6D88"}),onOk:async()=>{try{await y.API.delete("/api/user/device",{data:JSON.stringify({deviceID:t.macAddress}),headers:{"Content-Type":"application/json"}}),s(e.filter(e=>e.id!==a)),p.default.success(o.formatMessage({id:"pages.devices.unbind.success",defaultMessage:"\u8BBE\u5907\u5DF2\u89E3\u7ED1"}));}catch(e){var d,i;p.default.error((null==e?void 0:null===(i=e.response)||void 0===i?void 0:null===(d=i.data)||void 0===d?void 0:d.message)||o.formatMessage({id:"pages.devices.unbind.error",defaultMessage:"\u89E3\u7ED1\u5931\u8D25"}));}}});},w=(a,t)=>{s(e.map(e=>e.id===a?{...e,otaEnabled:t}:e)),p.default.success(o.formatMessage({id:t?"pages.devices.ota.enabled":"pages.devices.ota.disabled",defaultMessage:t?"OTA\u5347\u7EA7\u5DF2\u5F00\u542F":"OTA\u5347\u7EA7\u5DF2\u5173\u95ED"}));};return(0,d.jsxs)(n.PageContainer,{header:{title:o.formatMessage({id:"pages.devices.title",defaultMessage:"\u7BA1\u7406\u8BBE\u5907"}),breadcrumb:{items:[{path:"/console/agents",title:(0,d.jsx)("span",{style:{cursor:"pointer",color:"#1677ff"},onClick:()=>t("/console/agents"),children:o.formatMessage({id:"pages.devices.breadcrumb.agents",defaultMessage:"\u667A\u80FD\u4F53"})})},{title:o.formatMessage({id:"pages.devices.breadcrumb.devices",defaultMessage:"\u7BA1\u7406\u8BBE\u5907"})}]},extra:[(0,d.jsx)(l.default,{type:"primary",icon:(0,d.jsx)(v.default,{}),onClick:()=>{p.default.info(o.formatMessage({id:"pages.agents.addDevice.personalUnsupported",defaultMessage:"\u793E\u533A\u7248\u672C\u4E0D\u652F\u6301\u7ED1\u5B9A\u8BBE\u5907"}));},children:o.formatMessage({id:"pages.devices.button.addDevice",defaultMessage:"\u6DFB\u52A0\u8BBE\u5907"})},"add")]},children:[a&&(0,d.jsx)(j.default,{isOpen:_,onClose:()=>z(!1),onConfirm:()=>{z(!1),T();},agentID:Number(a)}),(0,d.jsx)(u.default,{gutter:[16,16],children:e.map(e=>(0,d.jsx)(g.default,{xs:24,sm:12,md:8,lg:6,children:(0,d.jsx)(r.default,{size:"small",style:{borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},actions:[(0,d.jsx)(x.default,{onClick:()=>k(e.id),style:{color:"#999"}},"close")],children:(0,d.jsx)("div",{style:{padding:"8px 0"},children:(0,d.jsxs)(f.default,{direction:"vertical",size:"middle",style:{width:"100%"},children:[(0,d.jsx)("div",{children:(0,d.jsx)(A,{strong:!0,style:{fontSize:"16px"},children:e.name&&e.name.trim()?e.name:o.formatMessage({id:"pages.devices.device.unnamed",defaultMessage:"\u672A\u547D\u540D\u8BBE\u5907"})})}),(0,d.jsxs)("div",{children:[(0,d.jsxs)(A,{type:"secondary",style:{fontSize:"12px"},children:[o.formatMessage({id:"pages.devices.device.macAddress",defaultMessage:"Mac\u5730\u5740"}),":"]}),(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center",marginTop:4},children:[(0,d.jsx)(A,{style:{fontSize:"14px",marginRight:8},children:S(e.macAddress)}),(0,d.jsx)(h.default,{style:{color:"#1890ff",cursor:"pointer",fontSize:"12px"},onClick:()=>C(e.macAddress)})]})]}),(0,d.jsxs)("div",{children:[(0,d.jsxs)(A,{type:"secondary",style:{fontSize:"12px"},children:[o.formatMessage({id:"pages.devices.device.lastActive",defaultMessage:"\u6700\u8FD1\u5BF9\u8BDD"}),":"]}),(0,d.jsx)("div",{style:{marginTop:4},children:(0,d.jsx)(A,{style:{fontSize:"14px"},children:e.lastActive})})]}),(0,d.jsxs)("div",{children:[(0,d.jsxs)(A,{type:"secondary",style:{fontSize:"12px"},children:[o.formatMessage({id:"pages.devices.device.firmwareVersion",defaultMessage:"\u56FA\u4EF6\u7248\u672C"}),":"]}),(0,d.jsx)("div",{style:{marginTop:4},children:(0,d.jsx)(A,{style:{fontSize:"14px"},children:e.firmwareVersion})})]}),(0,d.jsx)("div",{children:(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,d.jsxs)(A,{type:"secondary",style:{fontSize:"12px"},children:[o.formatMessage({id:"pages.devices.device.otaUpgrade",defaultMessage:"OTA\u5347\u7EA7"}),":"]}),(0,d.jsx)(c.default,{checked:e.otaEnabled,onChange:s=>w(e.id,s),size:"small"})]})})]})})})},e.id))})]});};}}]);
//# sourceMappingURL=264c2324-async.7e61547b.js.map